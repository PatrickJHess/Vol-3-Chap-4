
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Inferring zero prices from the present value function &#8212; Basic Bond Concepts of Fixed Icome: Accrued Interest and Bond Payment Data</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Inferring_Zero_Prices';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Using the linalg module of NumPy" href="Using_the_linalg_module_of_NumPy.html" />
    <link rel="prev" title="Bootstrapping The Terms Structure With A Few Hundred Bonds" href="Chapter_Four_Highlights.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Basic Bond Concepts of Fixed Icome: Accrued Interest and Bond Payment Data</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Financial Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Interacting%20With%20Jupyter%20Books.html">Working with Jupyter Books</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Basic Concepts of Fixed Income: Chapter Four</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="Chapter_Four_Highlights.html">Bootstrapping The Terms Structure With A Few Hundred Bonds</a><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#"><strong>Inferring zero prices from the present value function</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="Using_the_linalg_module_of_NumPy.html">Using the linalg module of NumPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="Creating_The_Payoff_Matrix.html">Creating the payoff matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="Bootstrapping_The_Term_Structure_With_304_Bonds.html">Bootstrapping the term structure with 304 bonds</a></li>

<li class="toctree-l2"><a class="reference internal" href="imported_functions_Four.html">Function Imported by Chapter Four.</a></li>
</ul><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/PatrickJHess/Vol-3-Chap-4/issues/new?title=Issue%20on%20page%20%2FInferring_Zero_Prices.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button"
   title="Open an issue"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Inferring_Zero_Prices.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Inferring zero prices from the present value function</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#two-bond-example-recursive-solution"><strong>Two bond example-recursive solution</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#two-bond-example-as-two-equations-and-two-unknowns"><strong>Two bond example-as two equations and two unknowns</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-a-zero-coupon-bond-with-a-maturity-of-one-year-and-a-price-0f-96"><strong>Adding a zero-coupon bond with a maturity of one year and a price 0f \$96.</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#least-squares-solution"><strong>Least-Squares solution</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretation-of-the-result"><strong>Interpretation of the Result</strong></a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="inferring-zero-prices-from-the-present-value-function">
<h1><strong>Inferring zero prices from the present value function</strong><a class="headerlink" href="#inferring-zero-prices-from-the-present-value-function" title="Link to this heading">#</a></h1>
<p>The present value of a bond maturing in T periods is:</p>
<div class="math notranslate nohighlight">
\[\text{Bond Value} = \sum_{t=1}^{T-1}\text{PV(t)}\times \text{Coupon} + \text{PV(T)}\times (\text{Principal + Coupon})\]</div>
<br>
<p>where <span class="math notranslate nohighlight">\(\text{PV(t)}\)</span> is the present value factor at time <span class="math notranslate nohighlight">\(t\)</span>. The present value factor at <span class="math notranslate nohighlight">\(T\)</span> is solved for by rearranging the <span class="math notranslate nohighlight">\(\text{Bond Value}\)</span> equation:</p>
<div class="math notranslate nohighlight">
\[\large \text{PV(T)} = \frac{\text{Bond Value} - \sum_{t=1}^{T-1}\text{PV(t)}\times \text{Coupon}}{\text{Principal + Coupon}}\]</div>
<br>
<p>This formula allows for the recursive calculation of present value factors (zero prices), beginning with the shortest maturity and progressively solving for factors at longer maturity dates.</p>
<section id="two-bond-example-recursive-solution">
<h2><strong>Two bond example-recursive solution</strong><a class="headerlink" href="#two-bond-example-recursive-solution" title="Link to this heading">#</a></h2>
<p>Consider two bonds:</p>
<ol class="arabic simple">
<li><p>A bond that pays \$100 in six months and sells for $97.50.</p></li>
<li><p>A bond that matures in one year, pays a semi-annual $2 coupon, and sells for $100.</p></li>
</ol>
<p>The present value factor for six months, <span class="math notranslate nohighlight">\(\text{PV(0.5)}\)</span>, is the ratio of the price to the final payment for the first bond:</p>
<br>
<div class="math notranslate nohighlight">
\[\text{PV(0.5)} =\frac{97.5}{100} = 0.975\]</div>
<br>
<p>We can then use this six-month present value factor and the price of the one-year bond to infer the one-year present value factor, <span class="math notranslate nohighlight">\(\text{PV(1).}\)</span>. The one-year bond’s price ($100) must equal the present value of its two cash flows: the first coupon ($2) and the final payment <span class="math notranslate nohighlight">\(\text{(coupon + principal=\$102).}\)</span></p>
<br>
<div class="math notranslate nohighlight">
\[\$100 = 2 \times \text{PV}(0.5) + 102 \times \text{PV}(1)\]</div>
<p>Solving for <span class="math notranslate nohighlight">\(\text{PV(1)}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\text{PV}(1) = \frac{100 - (0.975 \times 2)}{102} = 0.9613\]</div>
<br>
<p>One might initially think this recursive approach could be used to build the complete term structure. However, while straightforward, this method is not well-suited for reliably deducing the entire term structure from a set of bond prices. To understand why this approach is problematic and to develop a more effective method, we must first reframe the problem as a system of equations.</p>
</section>
<section id="two-bond-example-as-two-equations-and-two-unknowns">
<h2><strong>Two bond example-as two equations and two unknowns</strong><a class="headerlink" href="#two-bond-example-as-two-equations-and-two-unknowns" title="Link to this heading">#</a></h2>
<p>Here we describe how to determine zero-coupon bond prices (or present value factors) using the prices and cash flows of one-period and two-period coupon bonds; a common technique in finance known as bootstrapping.</p>
<p>The values of the two bonds are first expressed as a system of two linear equations:</p>
<br>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(97.5 = 100\times \text{PV(0.5)}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(100 = 2\times \text{PV(0.5)} + 102\times \text{PV(1)}\)</span></p></li>
</ol>
<br>
<p>These equations can be represented in matrix form:</p>
<br>
<p><span class="math notranslate nohighlight">\(\text{Bond Values} = \text{Payoffs} \times \text{Zero Prices}\)</span></p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\text{Bond Values} =\begin{pmatrix}
97.5  \\
100  \\
\end{pmatrix}
\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{Zero Prices}\hspace{.4cm}=\begin{pmatrix}
PV(0.5)  \\
PV(1)  \\
\end{pmatrix}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{Payoffs} \hspace{1.15cm}=\begin{pmatrix}
100 &amp;0  \\
2 &amp;102  \\
\end{pmatrix}\)</span></p></li>
</ol>
<br>
<p><span class="math notranslate nohighlight">\(\Large\begin{pmatrix}
97.5  \\
100  \\
\end{pmatrix}= \begin{pmatrix}
100 &amp;0  \\
2 &amp;102  \\
\end{pmatrix}
\times\begin{pmatrix}
PV(0.5)  \\
PV(1)  \\
\end{pmatrix}\)</span></p>
<br>
<br>
<p>The goal is to solve for the <span class="math notranslate nohighlight">\(\text{Zero Prices}\)</span> array. Since the <span class="math notranslate nohighlight">\(\text{Payoffs}\)</span> array is a square matrix, we can use its inverse to solve the system of equations. The inverse of the <span class="math notranslate nohighlight">\(\text{Payoffs}\)</span> matrix is:</p>
<br>
<br>
<div class="math notranslate nohighlight">
\[\begin{split}\text{Payoffs}^{-1} = \Large\begin{pmatrix}
100 &amp;0  \\
2 &amp;102  \\
\end{pmatrix}^{-1} = \begin{pmatrix}
\frac{1}{100} &amp;0  \\
\frac{-2}{100\times 102} &amp;\frac{1}{102}  \\
\end{pmatrix} \end{split}\]</div>
<br>
<br>
<p>Multiplying both sides of the matrix equation by the inverse of the <span class="math notranslate nohighlight">\(\text{Payoffs}\)</span> matrix allows us to solve for the <span class="math notranslate nohighlight">\(\text{Zero Prices}\)</span>:</p>
<br>
<div class="math notranslate nohighlight">
\[\begin{split}\Large\begin{pmatrix}
\frac{1}{100} &amp;0  \\
\frac{-2}{100\times 102} &amp;\frac{1}{102}  \\
\end{pmatrix}\times\large \begin{pmatrix}
97.5  \\
100  \\
\end{pmatrix}=\begin{pmatrix}
\ 1 &amp;0  \\
\ 0 &amp; 1  \\
\end{pmatrix}\times\begin{pmatrix}
\text{PV(0.5)}  \\
\text{PV(1)}  \\
\end{pmatrix}
\end{split}\]</div>
<br>
<p>The first zero price factor, <span class="math notranslate nohighlight">\(\text{PV(0.5)}\)</span>, is calculated by multiplying the first row of the inverse matrix into the <span class="math notranslate nohighlight">\(\text{Bond Values}\)</span> vector:
$<span class="math notranslate nohighlight">\(
\text{PV(0.5)} = \frac{1}{100} \times 97.5 + 0 \times 100 = \frac{97.5}{100} = 0.975
\)</span>$</p>
<br>
<p>The second zero price factor, <span class="math notranslate nohighlight">\(\text{PV(1)}\)</span>, is calculated by multiplying the second row of the inverse matrix into the <span class="math notranslate nohighlight">\(\text{Bond Values}\)</span> vector:<br></p>
<br>
<div class="math notranslate nohighlight">
\[
PV(1) = \frac{-2}{100 \times 102} \times 97.5 + \frac{1}{102} \times 100 = \frac{100 - 2 \times PV(0.5)}{102} = \frac{100 - 2 \times 0.975}{102} = \frac{98.05}{102} \approx 0.9613\]</div>
<br>
<p>Results that are identical to the two-bond recursive solution.</p>
<br>
</section>
<section id="adding-a-zero-coupon-bond-with-a-maturity-of-one-year-and-a-price-0f-96">
<h2><strong>Adding a zero-coupon bond with a maturity of one year and a price 0f \$96.</strong><a class="headerlink" href="#adding-a-zero-coupon-bond-with-a-maturity-of-one-year-and-a-price-0f-96" title="Link to this heading">#</a></h2>
<p>We now have three equations and two unknowns.  Importantly notice that the <span class="math notranslate nohighlight">\(\text{Payoffs}\)</span> array has more rows than columns (not square or invertible).</p>
<br>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\text{Bond Values} =\begin{pmatrix}
97.5  \\
100  \\
96  \\
\end{pmatrix}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{Zero Prices} \hspace{.49cm}=\begin{pmatrix}
PV(0.5)  \\
PV(1)  \\
\end{pmatrix}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{Payoffs} \hspace{1.6cm}=\begin{pmatrix}
100 &amp;0  \\
2 &amp;102 \\
0 &amp; 100
\end{pmatrix}\)</span></p></li>
</ol>
<br>
<br>
<p><span class="math notranslate nohighlight">\(\large\begin{pmatrix}
97.5  \\
100  \\
96   \\
\end{pmatrix}= \begin{pmatrix}
100 &amp;0  \\
2 &amp;102  \\
0 &amp; 100 \\
\end{pmatrix}
\times\begin{pmatrix}
PV(1)  \\
PV(2)  \\
\end{pmatrix}\)</span></p>
<br>
<br>
<p>With three equations and two unknowns, there are three possible solutions:</p>
<ol class="arabic simple">
<li><p>The solution already achieved with the six-month and twelve month coupon bond.</p></li>
<li><p>A solution with the six-month bond and the one-year zero-coupon bond.</p></li>
<li><p>A solution with the coupon one-year bond and the one-year zero-coupon bond.</p></li>
</ol>
<p>The system is overdetermined.  The solution, however, can be found using least-squares estimation.</p>
</section>
<section id="least-squares-solution">
<h2><strong>Least-Squares solution</strong><a class="headerlink" href="#least-squares-solution" title="Link to this heading">#</a></h2>
<p>To solve this overdetermined system, we utilize the transpose of the Payoffs matrix, a common technique for finding the least-squares estimates.
The transpose of the Payoffs Matrix is denoted as <span class="math notranslate nohighlight">\(\text{Payoffs}^{T}\)</span>. The following steps describe the least-squares technique:</p>
<ol class="arabic simple">
<li><p>The transpose swaps the rows and columns:<br><br><span class="math notranslate nohighlight">\(\text{Payoffs}^{T}=\begin{pmatrix}
100 &amp; 2 &amp;0  \\
0 &amp;102 &amp; 100 \\
\end{pmatrix}
\)</span></p></li>
<li><p>The product of the transpose and the original payoff matrix:<br><br><span class="math notranslate nohighlight">\(\begin{pmatrix}
100 &amp; 2 &amp;0  \\
0 &amp;102 &amp; 100 \\
\end{pmatrix}\times\begin{pmatrix}
100 &amp;0\\
2 &amp; 102\\
0 &amp; 100\\
\end{pmatrix}=\begin{pmatrix}
10\,004 &amp; 204\\
204 &amp; 20\,004\\
\end{pmatrix}\)</span><br></p></li>
<li><p>Solve for the present value factors with the product of the inverse and original payoff matrix:<br><br>
<span class="math notranslate nohighlight">\(\begin{pmatrix}
10\,004 &amp; 204\\
204 &amp; 20\,004\\
\end{pmatrix}\times\begin{pmatrix}
97.5  \\
100  \\
96  \\
\end{pmatrix}=\begin{pmatrix}
10\,004 &amp; 204\\
204 &amp; 20\,004\\
\end{pmatrix}\times\begin{pmatrix}
\text{PV(0.5)}\\
\text{PV(1)}\\
\end{pmatrix}
\)</span></p></li>
<li><p>Get the solution by multiplying both sides by the inverse of the product of transpose and original payoff matrix:<br><br><span class="math notranslate nohighlight">\(\normalsize\begin{pmatrix}
0.97501\\
0.96064\\
\end{pmatrix}=\begin{pmatrix}
PV(0.5)\\
PV(1)\\
\end{pmatrix}\)</span></p></li>
</ol>
<br>
</section>
<section id="interpretation-of-the-result">
<h2><strong>Interpretation of the Result</strong><a class="headerlink" href="#interpretation-of-the-result" title="Link to this heading">#</a></h2>
<p>These estimates are the least-squares estimates, meaning they minimize the squared difference between the actual bond prices and the prices predicted by the estimated <span class="math notranslate nohighlight">\(\text{PV(0.5)}\)</span> and <span class="math notranslate nohighlight">\(\text{PV(1)}\)</span>.
The six-month zero price (<span class="math notranslate nohighlight">\(0.97501\)</span>) is slightly higher than the value calculated using just the first two bonds.
The one-year zero price (<span class="math notranslate nohighlight">\(0.9606\)</span>) is slightly lower than the value calculated using just the first two bonds.</p>
<p>The least-squares technique is the standard way of incorporating as many data points (bonds) as possible.  All things the same, the more bonds the more reliable is the estimate of the term structure. We’ll implement the least-square technique with functions from NumPy’s linear algebra module. The notebook <em>NumPy linalg and using sets</em> of this chapter illustrates the use of the module.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "PatrickJHess/Vol-3-Chap-4",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Chapter_Four_Highlights.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Bootstrapping The Terms Structure With A Few Hundred Bonds</p>
      </div>
    </a>
    <a class="right-next"
       href="Using_the_linalg_module_of_NumPy.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Using the linalg module of NumPy</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#two-bond-example-recursive-solution"><strong>Two bond example-recursive solution</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#two-bond-example-as-two-equations-and-two-unknowns"><strong>Two bond example-as two equations and two unknowns</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-a-zero-coupon-bond-with-a-maturity-of-one-year-and-a-price-0f-96"><strong>Adding a zero-coupon bond with a maturity of one year and a price 0f \$96.</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#least-squares-solution"><strong>Least-Squares solution</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretation-of-the-result"><strong>Interpretation of the Result</strong></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Financial Python
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025 by Arbitrage Partners..
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>