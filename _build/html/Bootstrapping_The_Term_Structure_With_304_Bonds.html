
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Bootstrapping the term structure with 304 bonds &#8212; Basic Concepts of Fixed Income: Bootstrapping the Term Structure with a Few Hundred Bonds</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Bootstrapping_The_Term_Structure_With_304_Bonds';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Function Imported by Chapter Four." href="imported_functions_Four.html" />
    <link rel="prev" title="Creating the payoff matrix" href="Creating_The_Payoff_Matrix.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Basic Concepts of Fixed Income: Bootstrapping the Term Structure with a Few Hundred Bonds</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Financial Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Interacting%20With%20Jupyter%20Books.html">Working with Jupyter Books</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Basic Concepts of Fixed Income: Chapter Four</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="Chapter_Four_Highlights.html">Bootstrapping The Terms Structure With A Few Hundred Bonds</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Inferring_Zero_Prices.html"><strong>Inferring zero prices from the present value function</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="Using_the_linalg_module_of_NumPy.html">Using the linalg module of NumPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="Creating_The_Payoff_Matrix.html">Creating the payoff matrix</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Bootstrapping the term structure with 304 bonds</a></li>

<li class="toctree-l2"><a class="reference internal" href="imported_functions_Four.html">Function Imported by Chapter Four.</a></li>
</ul><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/PatrickJHess/Vol-3-Chap-4/master?urlpath=tree/Bootstrapping_The_Term_Structure_With_304_Bonds.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/PatrickJHess/Vol-3-Chap-4/blob/master/Bootstrapping_The_Term_Structure_With_304_Bonds.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>



<a href="https://github.com/PatrickJHess/Vol-3-Chap-4/issues/new?title=Issue%20on%20page%20%2FBootstrapping_The_Term_Structure_With_304_Bonds.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button"
   title="Open an issue"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Bootstrapping_The_Term_Structure_With_304_Bonds.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Bootstrapping the term structure with 304 bonds</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Bootstrapping the term structure with 304 bonds</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#this-notebook-calculates-the-term-structure-of-interest-rates-for-304-coupon-bonds-it-utilizes-the-function-developed-in-chapters-two-and-three-as-well-as-the-using-the-linalg-module-of-numpy-and-creating-the-payoff-matrix-notebooks-from-this-chapter-the-necessary-functions-are-imported-from-a-custom-module-demonstrating-the-ability-to-skip-their-development-and-leapfrog-over-previous-chapters-and-notebooks">This notebook calculates the term structure of interest rates for 304 coupon bonds. It utilizes the function developed in Chapters Two and Three, as well as the <em>Using the linalg module of NumPy</em> and <em>Creating the payoff matrix</em> notebooks from this chapter. The necessary functions are imported from a custom module, demonstrating the ability to skip their development and “leapfrog” over previous chapters and notebooks.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-libraries-modules-and-functions">Importing libraries, modules, and functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#as-in-earlier-chapters-of-the-volume-modules-that-are-included-in-the-standard-python-library-are-imported-when-necessary-other-modules-or-libraries-are-installed-before-they-are-imported">As in earlier chapters of the volume, modules that are included in the standard Python library are imported. When necessary, other modules or libraries are installed before they are imported.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-a-custom-module-and-importing-functions">Adding a custom module and importing functions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-used-to-estimate-the-term-structure">Data Used To Estimate The Term Structure</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-read-excel-method-converts-the-workbook-sheet-into-a-pandas-dataframe-and-requires-a-url-address-here-the-index-of-the-dataframe-is-assigned-the-first-column-of-the-sheet-and-the-sheet-is-identified-as-fidelity-data">The <font color="green">read_excel()</font> method converts the workbook sheet into a Pandas DataFrame and requires a URL address.  Here the index of the DataFrame is assigned the first column of the sheet and the sheet is identified as ‘Fidelity Data’.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#identifying-bonds-that-mature-on">Identifying bonds that mature On:</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-code-segment-works-as-follows">The code segment works as follows:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-eleven-bond-example-of-the-notebook-creating-the-payoff-matrix">The eleven bond example of the notebook <em>Creating the payoff matrix</em>.</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-the-payoff-matrix-for-the-eleven-bonds">Create the payoff matrix for the eleven bonds.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#displaying-the-payoff-array-of-sample-bonds-as-a-pandas-dataframe">Displaying the payoff array of sample_bonds as a Pandas DataFrame.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#application-determine-the-payoff-matrix-for-the-first-twenty-bonds-in-bond-data-datafame"><font color="green">Application: Determine the payoff matrix for the first twenty bonds in bond_data DataFame</font></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimate-zero-prices-for-the-five-unique-dates-of-the-sample-bonds-dataframe">Estimate zero prices for the five unique dates of the sample_bonds DataFrame</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-accrued-interest-and-transaction-prices">Calculating accrued interest and transaction prices</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-the-lstsq-of-linalg-module-of-numpy-library">Use the <font color="green">lstsq</font> of linalg module of NumPy library</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-eleven-bond-results">The eleven bond results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#application-estimate-the-term-structure-with-the-first-twenty-five-bonds"><font color="green">Application: Estimate the term structure with the first twenty five bonds</font></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#see-chapter-three-hints-payoff-matrix-first-20-bonds-and-check-the-expected-results-here">see Chapter Three Hints: payoff matrix first 20 bonds and check the expected results here.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimate-zero-prices-for-149-unique-dates-with-304-bonds-of-bond-data-dataframe">Estimate zero prices for 149 unique dates with 304 bonds of bond_data DataFrame</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-304-bond-results">The 304 bond results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#notable-forward-rate-estimates">Notable forward rate estimates</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-least-squares-ols-zero-price-estimates-for-149-unique-dates">Plot Least Squares (OLS) Zero Price Estimates for 149 unique dates</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#pricing-bonds-with-zero-price-estimates"><em><strong>Pricing Bonds With Zero Price Estimates</strong></em></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-would-investors-use-this-analysis">How would investors use this analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chapter-exercise"><span style="text-align: left; color:green; font-family: 'Franklin Gothic Medium', sans-serif; margin-top: 1.0em; margin-bottom: 0em; font-style: italic;">Chapter Exercise</span></a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="bootstrapping-the-term-structure-with-304-bonds">
<h1>Bootstrapping the term structure with 304 bonds<a class="headerlink" href="#bootstrapping-the-term-structure-with-304-bonds" title="Link to this heading">#</a></h1>
<section id="this-notebook-calculates-the-term-structure-of-interest-rates-for-304-coupon-bonds-it-utilizes-the-function-developed-in-chapters-two-and-three-as-well-as-the-using-the-linalg-module-of-numpy-and-creating-the-payoff-matrix-notebooks-from-this-chapter-the-necessary-functions-are-imported-from-a-custom-module-demonstrating-the-ability-to-skip-their-development-and-leapfrog-over-previous-chapters-and-notebooks">
<h2>This notebook calculates the term structure of interest rates for 304 coupon bonds. It utilizes the function developed in Chapters Two and Three, as well as the <em>Using the linalg module of NumPy</em> and <em>Creating the payoff matrix</em> notebooks from this chapter. The necessary functions are imported from a custom module, demonstrating the ability to skip their development and “leapfrog” over previous chapters and notebooks.<a class="headerlink" href="#this-notebook-calculates-the-term-structure-of-interest-rates-for-304-coupon-bonds-it-utilizes-the-function-developed-in-chapters-two-and-three-as-well-as-the-using-the-linalg-module-of-numpy-and-creating-the-payoff-matrix-notebooks-from-this-chapter-the-necessary-functions-are-imported-from-a-custom-module-demonstrating-the-ability-to-skip-their-development-and-leapfrog-over-previous-chapters-and-notebooks" title="Link to this heading">#</a></h2>
</section>
<section id="importing-libraries-modules-and-functions">
<h2>Importing libraries, modules, and functions<a class="headerlink" href="#importing-libraries-modules-and-functions" title="Link to this heading">#</a></h2>
<section id="as-in-earlier-chapters-of-the-volume-modules-that-are-included-in-the-standard-python-library-are-imported-when-necessary-other-modules-or-libraries-are-installed-before-they-are-imported">
<h3>As in earlier chapters of the volume, modules that are included in the standard Python library are imported. When necessary, other modules or libraries are installed before they are imported.<a class="headerlink" href="#as-in-earlier-chapters-of-the-volume-modules-that-are-included-in-the-standard-python-library-are-imported-when-necessary-other-modules-or-libraries-are-installed-before-they-are-imported" title="Link to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>import sys
import requests
from types import ModuleType
from datetime import datetime, date

try:
    import numpy as np
except:
    !pip install numpy
    import numpy as np

try:
    import pandas as pd
except:
    !pip install pandas
    import pandas as pd
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import OS to interact with local computer operating system</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">types</span><span class="w"> </span><span class="kn">import</span> <span class="n">ModuleType</span>
<span class="c1"># Import the datetime and date classes from the datetime module</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">date</span>

<span class="c1"># Import the NumPy library for numerical operations, commonly aliased as np.</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="k">except</span><span class="p">:</span>
    <span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>numpy
    <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Import the pandas library for data manipulation and analysis, aliased as pd.</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="k">except</span><span class="p">:</span>
    <span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>pandas
    <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="adding-a-custom-module-and-importing-functions">
<h3>Adding a custom module and importing functions<a class="headerlink" href="#adding-a-custom-module-and-importing-functions" title="Link to this heading">#</a></h3>
<p>The notebook utilizes the custom module, <strong>module_basic_concepts_fixed_income</strong>, sourced from Dropbox and named <strong>basic_concepts_fixed_income</strong>. This module provides three core functions to streamline the focus on financial concepts:</p>
<ul class="simple">
<li><p><strong>one_y_axis</strong> (Chapter One): This function plots zero prices determined via the bootstrapping method.</p>
<ul>
<li><p><a class="reference external" href="https://patrickjhess.github.io/Imported-Functions/one_y_axis.html#one-y-axis-is-a-helper-function-for-plotting-graphs-created-by-financial-python">View Details</a></p></li>
</ul>
</li>
<li><p><strong>accrued_interest</strong> (Chapter Two): This function calculates the accrued interest on a settlement date.</p>
<ul>
<li><p><a class="reference external" href="https://patrickjhess.github.io/Imported-Functions/accrued_interest.html#accrued-interest-is-a-helper-function-that-calculates-accrued-interest">View Details</a></p></li>
</ul>
</li>
<li><p><strong>create_payoff_matrix</strong> (This Chapter): This function calculates the payoff matrix required to bootstrap the term structure with coupon bonds.</p>
<ul>
<li><p><a class="reference external" href="https://patrickjhess.github.io/Imported-Functions/create_payoff_matrix.html">View Details</a></a></p></li>
</ul>
</li>
</ul>
<p>The module also contains various supporting helper functions, and it automatically manages the import and, if required, installation of necessary libraries and modules. This structure allows the user to concentrate fully on financial principles rather than complex Python implementation details.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">basic_concepts_fixed_income</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span><span class="n">one_y_axis</span><span class="p">,</span>
                                        <span class="n">accrued_interest</span><span class="p">,</span>
                                        <span class="n">create_payoff_matrix</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the URL of the Python module to be downloaded from Dropbox.</span>
<span class="c1"># The &#39;dl=1&#39; parameter in the URL forces a direct download of the file content.</span>
<span class="n">url</span><span class="o">=</span> <span class="s1">&#39;https://www.dropbox.com/scl/fi/4y5hjxlfphh1ngvbgo77q/</span><span class="se">\</span>
<span class="s1">module_-basic_concepts_fixed_income.py?rlkey=6oxi7mgka42veaat79hcv8boz&amp;st=87sztshr&amp;dl=1&#39;</span>
<span class="n">module_name</span><span class="o">=</span><span class="s1">&#39;basic_concepts_fixed_income&#39;</span>
<span class="c1"># Send an HTTP GET request to the URL and store the server&#39;s response.</span>
<span class="k">try</span><span class="p">:</span>
  <span class="n">response</span><span class="o">=</span><span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
  <span class="c1"># Raise an exception for bad status codes (like 404 Not Found)</span>
  <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
  <span class="n">module</span><span class="o">=</span> <span class="n">ModuleType</span><span class="p">(</span><span class="n">module_name</span><span class="p">)</span>
  <span class="c1">#Code contained in response.text executed</span>
  <span class="n">exec</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">module</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
  <span class="c1"># Module added to sys</span>
  <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">module_name</span><span class="p">]</span><span class="o">=</span><span class="n">module</span>
<span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;❌ Error: Could not fetch module from URL. </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;❌ Error: Failed to execute or import the module. </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Now that &#39;basic_concepts_fixed_income&#39; exists in the notebook, import the specific functions</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">basic_concepts_fixed_income</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span><span class="n">one_y_axis</span><span class="p">,</span>
                                        <span class="n">accrued_interest</span><span class="p">,</span>
                                        <span class="n">create_payoff_matrix</span><span class="p">,</span>
                                        <span class="n">create_workbook</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="data-used-to-estimate-the-term-structure">
<h2>Data Used To Estimate The Term Structure<a class="headerlink" href="#data-used-to-estimate-the-term-structure" title="Link to this heading">#</a></h2>
<p>####The 304 U.S. Treasury securities data in the sheet ‘Fidelity Data’ of the Excel workbook ‘Bond Price Data’ are used to estimate the zero prices for five years on the settlement date January 21<span class="math notranslate nohighlight">\(^{st}\)</span> 2025.</p>
<section id="the-read-excel-method-converts-the-workbook-sheet-into-a-pandas-dataframe-and-requires-a-url-address-here-the-index-of-the-dataframe-is-assigned-the-first-column-of-the-sheet-and-the-sheet-is-identified-as-fidelity-data">
<h3>The <font color='green'>read_excel()</font> method converts the workbook sheet into a Pandas DataFrame and requires a URL address.  Here the index of the DataFrame is assigned the first column of the sheet and the sheet is identified as ‘Fidelity Data’.<a class="headerlink" href="#the-read-excel-method-converts-the-workbook-sheet-into-a-pandas-dataframe-and-requires-a-url-address-here-the-index-of-the-dataframe-is-assigned-the-first-column-of-the-sheet-and-the-sheet-is-identified-as-fidelity-data" title="Link to this heading">#</a></h3>
<p>This Fidelity data is downloaded from DropBox and loaded into a Pandas DataFrame using the Panda’s <font color='green'>read_excel()</font> method.<span class="math notranslate nohighlight">\(^{2}\)</span></p>
<p>Three arguments are passed to the method:</p>
<ol class="arabic simple">
<li><p>The URL address (<font color='green'>url</font>) is required.</p></li>
<li><p>Assigning the index column is optional. The maturity dates, located in the first column, are set as the index of the DataFrame  (<font color='green'>index_col=’Maturity Date’</font>).</p></li>
<li><p>The worksheet name defaults to the first worksheet. The worksheet’s name, ‘Fidelity Data’, is the assigned sheet (<font color='green'>sheet_name=’Fidelity Data’</font>)</p></li>
</ol>
<p>The <font color='green'>display()</font>  function shows the first and last five rows confirming that data has been successfully accessed.</p>
<hr class="docutils" />
<p><span class="math notranslate nohighlight">\(^{2}\)</span> <a href='https://patrickjhess.github.io/Introduction-To-Python-For-Financial-Python/An_Introduction_To_Pandas.html#dataframes-csv-and-excel-files'>Pandas method read_excel</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#The full file path.</span>
<span class="n">url</span><span class="o">=</span><span class="s1">&#39;https://www.dropbox.com/scl/fi/lgnaj41bt8o9sv5a63rr1/</span><span class="se">\</span>
<span class="s1">bond_data_jan21_2025.xlsx?rlkey=twjzkcqo0g2ahvot78518ti4x&amp;st=ihc5feog&amp;dl=1&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Attempting to load data from: </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1">#Load the data from Excel, using the first column as the index.</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">bond_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;Maturity Date&#39;</span><span class="p">,</span><span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Fidelity Data&#39;</span><span class="p">)</span>

    <span class="c1"># Display the first and last 5 rows of the loaded DataFrame to verify it worked.</span>
    <span class="n">display</span><span class="p">(</span><span class="n">bond_data</span><span class="p">)</span>

<span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ERROR: File not found.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please check that the &#39;folder&#39; and &#39;file&#39; variables are spelled correctly&#39;</span><span class="se">\</span>
<span class="s2">&#39; and that the file exists in that location.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempting to load data from: https://www.dropbox.com/scl/fi/lgnaj41bt8o9sv5a63rr1/bond_data_jan21_2025.xlsx?rlkey=twjzkcqo0g2ahvot78518ti4x&amp;st=ihc5feog&amp;dl=1
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Description</th>
      <th>Coupon</th>
      <th>Price Bid</th>
      <th>Price Ask</th>
      <th>Bid Size</th>
      <th>Ask Size</th>
    </tr>
    <tr>
      <th>Maturity Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2025-01-28</th>
      <td>UNITED STATES TREAS BILLS ZERO CPN       0.000...</td>
      <td>0.000</td>
      <td>99.929</td>
      <td>99.930</td>
      <td>100000.0</td>
      <td>100000.0</td>
    </tr>
    <tr>
      <th>2025-01-30</th>
      <td>UNITED STATES TREAS BILLS ZERO CPN       0.000...</td>
      <td>0.000</td>
      <td>99.906</td>
      <td>99.907</td>
      <td>40000.0</td>
      <td>40000.0</td>
    </tr>
    <tr>
      <th>2025-01-31</th>
      <td>UNITED STATES TREAS SER U-2025          1.3750...</td>
      <td>1.375</td>
      <td>99.921</td>
      <td>99.934</td>
      <td>60000.0</td>
      <td>60000.0</td>
    </tr>
    <tr>
      <th>2025-01-31</th>
      <td>UNITED STATES TREAS SER AW-2025         4.1250...</td>
      <td>4.125</td>
      <td>99.988</td>
      <td>99.997</td>
      <td>60000.0</td>
      <td>60000.0</td>
    </tr>
    <tr>
      <th>2025-01-31</th>
      <td>UNITED STATES TREAS SER G-2025          2.5000...</td>
      <td>2.500</td>
      <td>99.953</td>
      <td>99.965</td>
      <td>60000.0</td>
      <td>60000.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2029-11-30</th>
      <td>UNITED STATES TREAS SER AG-2029         4.1250...</td>
      <td>4.125</td>
      <td>98.910</td>
      <td>98.914</td>
      <td>100000.0</td>
      <td>100000.0</td>
    </tr>
    <tr>
      <th>2029-11-30</th>
      <td>UNITED STATES TREAS SER S-2029          3.8750...</td>
      <td>3.875</td>
      <td>97.763</td>
      <td>97.782</td>
      <td>40000.0</td>
      <td>40000.0</td>
    </tr>
    <tr>
      <th>2029-12-31</th>
      <td>UNITED STATES TREAS SER T-2029          3.8750...</td>
      <td>3.875</td>
      <td>97.734</td>
      <td>97.738</td>
      <td>65000.0</td>
      <td>65000.0</td>
    </tr>
    <tr>
      <th>2029-12-31</th>
      <td>UNITED STATES TREAS SER AH-2029         4.3750...</td>
      <td>4.375</td>
      <td>99.988</td>
      <td>99.989</td>
      <td>7000.0</td>
      <td>7000.0</td>
    </tr>
    <tr>
      <th>2030-01-31</th>
      <td>UNITED STATES TREAS SER G-2030          3.5000...</td>
      <td>3.500</td>
      <td>95.994</td>
      <td>96.011</td>
      <td>16000.0</td>
      <td>16000.0</td>
    </tr>
  </tbody>
</table>
<p>304 rows × 6 columns</p>
</div></div></div>
</div>
</section>
<section id="identifying-bonds-that-mature-on">
<h3>Identifying bonds that mature On:<a class="headerlink" href="#identifying-bonds-that-mature-on" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>February 28<span class="math notranslate nohighlight">\(^{th}\)</span> 2025</p></li>
<li><p>July 15<span class="math notranslate nohighlight">\(^{th}\)</span> 2025</p></li>
<li><p>August 31<span class="math notranslate nohighlight">\(^{st}\)</span> 2025</p></li>
<li><p>January 15<span class="math notranslate nohighlight">\(^{th}\)</span> 2026</p></li>
<li><p>February 28<span class="math notranslate nohighlight">\(^{th}\)</span> 2026</p></li>
</ul>
<section id="the-code-segment-works-as-follows">
<h4>The code segment works as follows:<a class="headerlink" href="#the-code-segment-works-as-follows" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p>The iterable <font color='green'>maturity_dates</font> is defined, containing five specific dates.</p></li>
<li><p>The <font color='green'>sample_bonds</font> DataFrame is created by selecting securities from the <font color='green'>bond_data</font> DataFrame using its <font color='green'>loc</font> attribute.</p></li>
<li><p>The final line of code then displays the resulting &lt;<font color='green'>sample_bonds</font> DataFrame.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">maturity_dates</span><span class="o">=</span><span class="p">[</span><span class="n">date</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">date</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span><span class="n">date</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">31</span><span class="p">),</span>
            <span class="n">date</span><span class="p">(</span><span class="mi">2026</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span><span class="n">date</span><span class="p">(</span><span class="mi">2026</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">28</span><span class="p">)]</span>
<span class="n">sample_bonds</span><span class="o">=</span><span class="n">fixed_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">maturity_dates</span><span class="p">]</span>
<span class="n">display</span><span class="p">(</span><span class="n">sample_bonds</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --- Define a specific list of upcoming bond maturity dates to analyze ---</span>
<span class="c1"># These dates were selected for a targeted review of bonds maturing in</span>
<span class="c1"># late 2025 and early 2026.</span>
<span class="n">maturity_dates</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">date</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span>
    <span class="n">date</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span>
    <span class="n">date</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span>
    <span class="n">date</span><span class="p">(</span><span class="mi">2026</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span>
    <span class="n">date</span><span class="p">(</span><span class="mi">2026</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span>
<span class="p">]</span>

<span class="c1"># Use the .loc indexer to perform a label-based lookup.</span>
<span class="c1"># This retrieves all rows where the DataFrame&#39;s index exactly matches the dates in our list.</span>
<span class="n">sample_bonds</span> <span class="o">=</span> <span class="n">bond_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">maturity_dates</span><span class="p">]</span>

<span class="c1"># Render the resulting &#39;sample_bonds&#39; DataFrame as a formatted table in the output.</span>
<span class="c1"># display() is preferable to print() for viewing DataFrames in a notebook environment.</span>
<span class="n">display</span><span class="p">(</span><span class="n">sample_bonds</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Description</th>
      <th>Coupon</th>
      <th>Price Bid</th>
      <th>Price Ask</th>
      <th>Bid Size</th>
      <th>Ask Size</th>
    </tr>
    <tr>
      <th>Maturity Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2025-02-28</th>
      <td>UNITED STATES TREAS NOTE 1.12500% 02/28/2025</td>
      <td>1.125</td>
      <td>99.671</td>
      <td>99.684</td>
      <td>60000.0</td>
      <td>60000.0</td>
    </tr>
    <tr>
      <th>2025-02-28</th>
      <td>UNITED STATES TREAS SER AY-2025         4.6250...</td>
      <td>4.625</td>
      <td>100.019</td>
      <td>100.032</td>
      <td>60000.0</td>
      <td>60000.0</td>
    </tr>
    <tr>
      <th>2025-02-28</th>
      <td>UNITED STATES TREAS NOTES               2.7500...</td>
      <td>2.750</td>
      <td>99.837</td>
      <td>99.852</td>
      <td>40000.0</td>
      <td>40000.0</td>
    </tr>
    <tr>
      <th>2025-07-15</th>
      <td>UNITED STATES TREAS SER AQ-2025         3.0000...</td>
      <td>3.000</td>
      <td>99.394</td>
      <td>99.406</td>
      <td>60000.0</td>
      <td>60000.0</td>
    </tr>
    <tr>
      <th>2025-08-31</th>
      <td>UNITED STATES TREAS SER AC-2025         0.2500...</td>
      <td>0.250</td>
      <td>97.605</td>
      <td>97.610</td>
      <td>60000.0</td>
      <td>60000.0</td>
    </tr>
    <tr>
      <th>2025-08-31</th>
      <td>UNITED STATES TREAS SER BG-2025         5.0000...</td>
      <td>5.000</td>
      <td>100.406</td>
      <td>100.426</td>
      <td>60000.0</td>
      <td>60000.0</td>
    </tr>
    <tr>
      <th>2025-08-31</th>
      <td>UNITED STATES TREAS SER P-2025          2.7500...</td>
      <td>2.750</td>
      <td>99.070</td>
      <td>99.094</td>
      <td>60000.0</td>
      <td>60000.0</td>
    </tr>
    <tr>
      <th>2026-01-15</th>
      <td>UNITED STATES TREAS SER AJ-2026         3.8750...</td>
      <td>3.875</td>
      <td>99.671</td>
      <td>99.688</td>
      <td>40000.0</td>
      <td>40000.0</td>
    </tr>
    <tr>
      <th>2026-02-28</th>
      <td>UNITED STATES TREAS SER AY-2026         4.6250...</td>
      <td>4.625</td>
      <td>100.375</td>
      <td>100.387</td>
      <td>50000.0</td>
      <td>50000.0</td>
    </tr>
    <tr>
      <th>2026-02-28</th>
      <td>UNITED STATES TREAS SER H-2026          2.5000...</td>
      <td>2.500</td>
      <td>98.109</td>
      <td>98.122</td>
      <td>19000.0</td>
      <td>19000.0</td>
    </tr>
    <tr>
      <th>2026-02-28</th>
      <td>UNITED STATES TREAS SER V-2026          0.5000...</td>
      <td>0.500</td>
      <td>95.968</td>
      <td>95.989</td>
      <td>40000.0</td>
      <td>40000.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
</section>
<section id="the-eleven-bond-example-of-the-notebook-creating-the-payoff-matrix">
<h2>The eleven bond example of the notebook <em>Creating the payoff matrix</em>.<a class="headerlink" href="#the-eleven-bond-example-of-the-notebook-creating-the-payoff-matrix" title="Link to this heading">#</a></h2>
<section id="create-the-payoff-matrix-for-the-eleven-bonds">
<h3>Create the payoff matrix for the eleven bonds.<a class="headerlink" href="#create-the-payoff-matrix-for-the-eleven-bonds" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">settlement</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">21</span><span class="p">)</span>
<span class="n">freq</span><span class="o">=</span><span class="mi">2</span>
<span class="n">create_payoff_matrix</span><span class="p">(</span><span class="n">sample_bonds</span><span class="p">,</span><span class="n">settlement</span><span class="o">=</span><span class="n">settlement</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="n">freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([[100.5625,   0.    ,   0.    ,   0.    ,   0.    ],
        [102.3125,   0.    ,   0.    ,   0.    ,   0.    ],
        [101.375 ,   0.    ,   0.    ,   0.    ,   0.    ],
        [  0.    , 101.5   ,   0.    ,   0.    ,   0.    ],
        [  0.125 ,   0.    , 100.125 ,   0.    ,   0.    ],
        [  2.5   ,   0.    , 102.5   ,   0.    ,   0.    ],
        [  1.375 ,   0.    , 101.375 ,   0.    ,   0.    ],
        [  0.    ,   1.9375,   0.    , 101.9375,   0.    ],
        [  2.3125,   0.    ,   2.3125,   0.    , 102.3125],
        [  1.25  ,   0.    ,   1.25  ,   0.    , 101.25  ],
        [  0.25  ,   0.    ,   0.25  ,   0.    , 100.25  ]]),
 [datetime.date(2025, 2, 28),
  datetime.date(2025, 7, 15),
  datetime.date(2025, 9, 2),
  datetime.date(2026, 1, 15),
  datetime.date(2026, 3, 2)])
</pre></div>
</div>
</div>
</div>
</section>
<section id="displaying-the-payoff-array-of-sample-bonds-as-a-pandas-dataframe">
<h3>Displaying the payoff array of sample_bonds as a Pandas DataFrame.<a class="headerlink" href="#displaying-the-payoff-array-of-sample-bonds-as-a-pandas-dataframe" title="Link to this heading">#</a></h3>
<p>Using the <font color='green'>create_payoff_matrix</font> function from the custom module <em>basic_concepts_fixed_income</em>, the payoff matrix for the sample bonds is generated and stored in the variable <font color='green'>payoffs_11</font>. The unique payment dates are then assigned to  <font color='green'>column_dates_11</font>. Finally, a DataFrame is constructed, utilizing the five unique dates as the column headers and the bonds’ maturities as the index.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define settlement date and payment frequency</span>
<span class="n">settlement</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">21</span><span class="p">)</span>
<span class="n">freq</span><span class="o">=</span><span class="mi">2</span>

<span class="c1"># create_payoff_matrix returns payment rows for each bond and unique payment dates</span>
<span class="n">payoffs_11</span><span class="p">,</span><span class="n">column_dates_11</span><span class="o">=</span><span class="n">create_payoff_matrix</span><span class="p">(</span><span class="n">sample_bonds</span><span class="p">,</span><span class="n">settlement</span><span class="o">=</span><span class="n">settlement</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="n">freq</span><span class="p">)</span>

<span class="c1"># Pandas DataFrame created from two-dimensional NumPy array payoffs_11</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">payoffs_11</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">column_dates_11</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">sample_bonds</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>2025-02-28</th>
      <th>2025-07-15</th>
      <th>2025-09-02</th>
      <th>2026-01-15</th>
      <th>2026-03-02</th>
    </tr>
    <tr>
      <th>Maturity Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2025-02-28</th>
      <td>100.5625</td>
      <td>0.0000</td>
      <td>0.0000</td>
      <td>0.0000</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>2025-02-28</th>
      <td>102.3125</td>
      <td>0.0000</td>
      <td>0.0000</td>
      <td>0.0000</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>2025-02-28</th>
      <td>101.3750</td>
      <td>0.0000</td>
      <td>0.0000</td>
      <td>0.0000</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>2025-07-15</th>
      <td>0.0000</td>
      <td>101.5000</td>
      <td>0.0000</td>
      <td>0.0000</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>2025-08-31</th>
      <td>0.1250</td>
      <td>0.0000</td>
      <td>100.1250</td>
      <td>0.0000</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>2025-08-31</th>
      <td>2.5000</td>
      <td>0.0000</td>
      <td>102.5000</td>
      <td>0.0000</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>2025-08-31</th>
      <td>1.3750</td>
      <td>0.0000</td>
      <td>101.3750</td>
      <td>0.0000</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>2026-01-15</th>
      <td>0.0000</td>
      <td>1.9375</td>
      <td>0.0000</td>
      <td>101.9375</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>2026-02-28</th>
      <td>2.3125</td>
      <td>0.0000</td>
      <td>2.3125</td>
      <td>0.0000</td>
      <td>102.3125</td>
    </tr>
    <tr>
      <th>2026-02-28</th>
      <td>1.2500</td>
      <td>0.0000</td>
      <td>1.2500</td>
      <td>0.0000</td>
      <td>101.2500</td>
    </tr>
    <tr>
      <th>2026-02-28</th>
      <td>0.2500</td>
      <td>0.0000</td>
      <td>0.2500</td>
      <td>0.0000</td>
      <td>100.2500</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="application-determine-the-payoff-matrix-for-the-first-twenty-bonds-in-bond-data-datafame">
<h2><font color='green'>Application: Determine the payoff matrix for the first twenty bonds in bond_data DataFame</font><a class="headerlink" href="#application-determine-the-payoff-matrix-for-the-first-twenty-bonds-in-bond-data-datafame" title="Link to this heading">#</a></h2>
<div style="
    border-left: 12px solid green;
    line-height: 1.5;
    padding: 15px">
<br>
<p>see <a class="reference external" href="https://colab.research.google.com/drive/1hSV2ArS-kEm3soW-sbIBTjWnnD3nMvkh#scrollTo=nFsV0fH8m2Nh">Chapter Four Hints: payoff matrix first 20 bonds</a> and check the <a class="reference external" href="https://colab.research.google.com/drive/1hrv5WQPxxuto7jIy1I6_fdyeAyhNCLaY#scrollTo=nFsV0fH8m2Nh">expected results here</a>.</p>
<div></section>
<section id="estimate-zero-prices-for-the-five-unique-dates-of-the-sample-bonds-dataframe">
<h2>Estimate zero prices for the five unique dates of the sample_bonds DataFrame<a class="headerlink" href="#estimate-zero-prices-for-the-five-unique-dates-of-the-sample-bonds-dataframe" title="Link to this heading">#</a></h2>
<section id="calculating-accrued-interest-and-transaction-prices">
<h3>Calculating accrued interest and transaction prices<a class="headerlink" href="#calculating-accrued-interest-and-transaction-prices" title="Link to this heading">#</a></h3>
<p>The transaction prices for the eleven bonds are assigned their bid/ask average plus accrued interest.
The process involves two main steps:</p>
<ol class="arabic simple">
<li><p><strong>Calculate Bid/Ask Average:</strong> The average is computed using the ‘Price Bid’ and ‘Price Ask’ columns in the DataFrame.</p></li>
<li><p><strong>Update DataFrame:</strong> The ‘Accrued’ column is added to <font color='green'>sample_bonds</font> DataFrame using the Pandas  <font color='green'>apply()</font> method and the ‘Transaction Prices’ column is added by adding accrued interest to the Bid/Ask average.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># apply the accrued_interest function to the DataFrame to populate a new column &#39;Accrued&#39;</span>
<span class="n">sample_bonds</span><span class="p">[</span><span class="s1">&#39;Accrued&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample_bonds</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">accrued_interest</span><span class="p">(</span>
        <span class="n">maturity</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="c1"># Assuming index is maturity</span>
        <span class="n">coupon</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;Coupon&#39;</span><span class="p">],</span>
        <span class="n">settlement</span><span class="o">=</span><span class="n">settlement</span><span class="p">,</span>
        <span class="n">freq</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">day_type</span><span class="o">=</span><span class="s1">&#39;Actual/Actual&#39;</span>
    <span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>

<span class="c1"># The new column &#39;Transaction Prices&#39; equals accrued interest plus the Bid/Ask average</span>
<span class="n">sample_bonds</span><span class="p">[</span><span class="s1">&#39;Transaction Prices&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">sample_bonds</span><span class="p">[</span><span class="s1">&#39;Price Bid&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">sample_bonds</span><span class="p">[</span><span class="s1">&#39;Price Ask&#39;</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>\
<span class="o">+</span><span class="n">sample_bonds</span><span class="p">[</span><span class="s1">&#39;Accrued&#39;</span><span class="p">]</span>
<span class="n">sample_bonds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Description</th>
      <th>Coupon</th>
      <th>Price Bid</th>
      <th>Price Ask</th>
      <th>Bid Size</th>
      <th>Ask Size</th>
      <th>Accrued</th>
      <th>Transaction Prices</th>
    </tr>
    <tr>
      <th>Maturity Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2025-02-28</th>
      <td>UNITED STATES TREAS NOTE 1.12500% 02/28/2025</td>
      <td>1.125</td>
      <td>99.671</td>
      <td>99.684</td>
      <td>60000.0</td>
      <td>60000.0</td>
      <td>0.444406</td>
      <td>100.121906</td>
    </tr>
    <tr>
      <th>2025-02-28</th>
      <td>UNITED STATES TREAS SER AY-2025         4.6250...</td>
      <td>4.625</td>
      <td>100.019</td>
      <td>100.032</td>
      <td>60000.0</td>
      <td>60000.0</td>
      <td>1.827003</td>
      <td>101.852503</td>
    </tr>
    <tr>
      <th>2025-02-28</th>
      <td>UNITED STATES TREAS NOTES               2.7500...</td>
      <td>2.750</td>
      <td>99.837</td>
      <td>99.852</td>
      <td>40000.0</td>
      <td>40000.0</td>
      <td>1.086326</td>
      <td>100.930826</td>
    </tr>
    <tr>
      <th>2025-07-15</th>
      <td>UNITED STATES TREAS SER AQ-2025         3.0000...</td>
      <td>3.000</td>
      <td>99.394</td>
      <td>99.406</td>
      <td>60000.0</td>
      <td>60000.0</td>
      <td>0.049724</td>
      <td>99.449724</td>
    </tr>
    <tr>
      <th>2025-08-31</th>
      <td>UNITED STATES TREAS SER AC-2025         0.2500...</td>
      <td>0.250</td>
      <td>97.605</td>
      <td>97.610</td>
      <td>60000.0</td>
      <td>60000.0</td>
      <td>0.099185</td>
      <td>97.706685</td>
    </tr>
    <tr>
      <th>2025-08-31</th>
      <td>UNITED STATES TREAS SER BG-2025         5.0000...</td>
      <td>5.000</td>
      <td>100.406</td>
      <td>100.426</td>
      <td>60000.0</td>
      <td>60000.0</td>
      <td>1.983696</td>
      <td>102.399696</td>
    </tr>
    <tr>
      <th>2025-08-31</th>
      <td>UNITED STATES TREAS SER P-2025          2.7500...</td>
      <td>2.750</td>
      <td>99.070</td>
      <td>99.094</td>
      <td>60000.0</td>
      <td>60000.0</td>
      <td>1.091033</td>
      <td>100.173033</td>
    </tr>
    <tr>
      <th>2026-01-15</th>
      <td>UNITED STATES TREAS SER AJ-2026         3.8750...</td>
      <td>3.875</td>
      <td>99.671</td>
      <td>99.688</td>
      <td>40000.0</td>
      <td>40000.0</td>
      <td>0.064227</td>
      <td>99.743727</td>
    </tr>
    <tr>
      <th>2026-02-28</th>
      <td>UNITED STATES TREAS SER AY-2026         4.6250...</td>
      <td>4.625</td>
      <td>100.375</td>
      <td>100.387</td>
      <td>50000.0</td>
      <td>50000.0</td>
      <td>1.827003</td>
      <td>102.208003</td>
    </tr>
    <tr>
      <th>2026-02-28</th>
      <td>UNITED STATES TREAS SER H-2026          2.5000...</td>
      <td>2.500</td>
      <td>98.109</td>
      <td>98.122</td>
      <td>19000.0</td>
      <td>19000.0</td>
      <td>0.987569</td>
      <td>99.103069</td>
    </tr>
    <tr>
      <th>2026-02-28</th>
      <td>UNITED STATES TREAS SER V-2026          0.5000...</td>
      <td>0.500</td>
      <td>95.968</td>
      <td>95.989</td>
      <td>40000.0</td>
      <td>40000.0</td>
      <td>0.197514</td>
      <td>96.176014</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="use-the-lstsq-of-linalg-module-of-numpy-library">
<h3>Use the <font color='green'>lstsq</font> of linalg module of NumPy library<a class="headerlink" href="#use-the-lstsq-of-linalg-module-of-numpy-library" title="Link to this heading">#</a></h3>
<p>The process for calculating estimated coefficients (zero prices) using the <font color='green'>lstsq</font> function from NumPy’s linalg module is as follows:</p>
<ol class="arabic simple">
<li><p><strong>Define the NumPy Array:</strong> Convert the ‘Transaction Prices’ column into a NumPy array named <font color='green'>transaction_prices</font> using the Pandas  <font color='green'>to_numpy</font> method.</p></li>
<li><p><strong>Execute the  <font color='green'>lstsq</font> function:</strong> Call the  <font color='green'>lstsq</font> function to perform the least-squares solution. The outputs of this function are assigned to the following variables:</p>
<ul class="simple">
<li><p><strong>Estimated Coefficients (zero prices):</strong>  <font color='green'>zero_prices_11</font></p></li>
<li><p><strong>Sum of Squared Residuals:</strong>  <font color='green'>ss2_11</font></p></li>
<li><p><strong>Rank of Payoff Matrix:</strong> <font color='green'>rank_11</font></p></li>
<li><p><strong>Relative Information Content of Payoff Matrix Columns:</strong>  <font color='green'>colInfo_11</font></p></li>
</ul>
</li>
<li><p><strong>Generate Output DataFrames:</strong></p>
<ul class="simple">
<li><p><strong>Term Structure DataFrame:</strong> <font color='green'>df_11</font> contains the calculated zero prices, along with the annualized spot and forward rates for the five unique dates.</p></li>
<li><p><strong>Summary Statistics DataFrame:</strong> <font color='green'>df_summary_11</font> includes the average of squared residuals, the rank of the payoff matrix, and the minimum and maximum values of the estimated information content for the columns.</p></li>
</ul>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate transaction prices</span>
<span class="n">transaction_prices</span><span class="o">=</span><span class="n">sample_bonds</span><span class="p">[</span><span class="s1">&#39;Transaction Prices&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

<span class="c1"># Estimate the present value factors with least squares</span>
<span class="n">zero_prices_11</span><span class="p">,</span><span class="n">ss2_11</span><span class="p">,</span><span class="n">rank_11</span><span class="p">,</span><span class="n">colInfo__11</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">payoffs_11</span><span class="p">,</span><span class="n">transaction_prices</span><span class="p">)</span>

<span class="c1"># Maturity of the bonds in years</span>
<span class="n">maturity_years</span><span class="o">=</span><span class="p">[(</span><span class="n">mat_date</span><span class="o">-</span><span class="n">settlement</span><span class="p">)</span><span class="o">.</span><span class="n">days</span><span class="o">/</span><span class="mi">365</span> <span class="k">for</span> <span class="n">mat_date</span> <span class="ow">in</span> <span class="n">column_dates_11</span><span class="p">]</span>

<span class="c1"># Continuously compounded annualized spot rates</span>
<span class="n">spot_rates_11</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">zero_prices_11</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">maturity_years</span><span class="p">)</span>

<span class="c1"># Continuously compounded annualized forward rates</span>
<span class="n">forward_rates_11</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">zero_prices_11</span><span class="p">))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">maturity_years</span><span class="p">)</span>
<span class="n">forward_rates_11</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">forward_rates_11</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

<span class="c1"># Create a DataFrame of least squares present value estimates and display results</span>
<span class="c1"># First a dictionary</span>
<span class="n">bonds_11</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Zero Pries: 11 Bonds&#39;</span><span class="p">:</span><span class="n">zero_prices_11</span><span class="p">,</span>
          <span class="s1">&#39;Spot Rates:11 Bonds&#39;</span><span class="p">:</span><span class="n">spot_rates_11</span><span class="p">,</span>
          <span class="s1">&#39;Forward Rates: 11 Bonds&#39;</span><span class="p">:</span><span class="n">forward_rates_11</span><span class="p">}</span>
<span class="c1"># Then a DataFrame</span>
<span class="n">df_11</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">bonds_11</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">column_dates_11</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_11</span><span class="p">)</span>

<span class="c1"># Create a DataFrame of summary statistics and display results</span>
<span class="c1"># First a dictionary</span>
<span class="n">summary_11</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Average Sum Squared Errors&#39;</span><span class="p">:</span><span class="n">ss2_11</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">sample_bonds</span><span class="p">),</span>
             <span class="s1">&#39;Payoff Rank&#39;</span><span class="p">:</span><span class="n">rank_11</span><span class="p">,</span>
             <span class="s1">&#39;Column Max Info&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">colInfo__11</span><span class="p">),</span>
             <span class="s1">&#39;Column Min Info&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">colInfo__11</span><span class="p">)}</span>

<span class="n">df_summary_11</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">summary_11</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Summary Statistics&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_summary_11</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_22904/4195404125.py:5: FutureWarning: `rcond` parameter will change to the default of machine precision times ``max(M, N)`` where M and N are the input matrix dimensions.
To use the future default and silence this warning we advise to pass `rcond=None`, to keep using the old, explicitly pass `rcond=-1`.
  zero_prices_11,ss2_11,rank_11,colInfo__11=np.linalg.lstsq(payoffs_11,transaction_prices)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Zero Pries: 11 Bonds</th>
      <th>Spot Rates:11 Bonds</th>
      <th>Forward Rates: 11 Bonds</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2025-02-28</th>
      <td>0.995580</td>
      <td>0.042547</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2025-07-15</th>
      <td>0.979800</td>
      <td>0.042562</td>
      <td>0.042566</td>
    </tr>
    <tr>
      <th>2025-09-02</th>
      <td>0.974662</td>
      <td>0.041819</td>
      <td>0.039166</td>
    </tr>
    <tr>
      <th>2026-01-15</th>
      <td>0.959856</td>
      <td>0.041656</td>
      <td>0.041386</td>
    </tr>
    <tr>
      <th>2026-03-02</th>
      <td>0.954456</td>
      <td>0.042010</td>
      <td>0.044773</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Summary Statistics</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Average Sum Squared Errors</th>
      <td>0.000018</td>
    </tr>
    <tr>
      <th>Payoff Rank</th>
      <td>5.000000</td>
    </tr>
    <tr>
      <th>Column Max Info</th>
      <td>177.808521</td>
    </tr>
    <tr>
      <th>Column Min Info</th>
      <td>100.730222</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="the-eleven-bond-results">
<h2>The eleven bond results<a class="headerlink" href="#the-eleven-bond-results" title="Link to this heading">#</a></h2>
<p>The estimated spot and forward rates are both annualized at approximately 4%. In contrast to the findings in Chapter One, the term structure in January of 2025 is flat, showing neither the upward trend seen in September 2022 nor the downward trend of September 2025. The reliability of the estimated zero prices is determined by the ratio of the maximum and minimum column information values; extremely high values indicate unreliable estimates. The observed values confirm that our estimates are, in fact, reliable.</p>
</section>
<section id="application-estimate-the-term-structure-with-the-first-twenty-five-bonds">
<h2><font color='green'>Application: Estimate the term structure with the first twenty five bonds</font><a class="headerlink" href="#application-estimate-the-term-structure-with-the-first-twenty-five-bonds" title="Link to this heading">#</a></h2>
<div style="
    border-left: 12px solid green;
    line-height: 1.5;
    padding: 15px">
<br>
<p>Create DataFrames for the term structure and summary statistics.</p>
<section id="see-chapter-three-hints-payoff-matrix-first-20-bonds-and-check-the-expected-results-here">
<h3>see <a class="reference external" href="https://colab.research.google.com/drive/1hSV2ArS-kEm3soW-sbIBTjWnnD3nMvkh#scrollTo=nFsV0fH8m2Nh">Chapter Three Hints: payoff matrix first 20 bonds</a> and check the <a class="reference external" href="https://colab.research.google.com/drive/1hrv5WQPxxuto7jIy1I6_fdyeAyhNCLaY#scrollTo=nFsV0fH8m2Nh">expected results here</a>.<a class="headerlink" href="#see-chapter-three-hints-payoff-matrix-first-20-bonds-and-check-the-expected-results-here" title="Link to this heading">#</a></h3>
<br>
</div></section>
</section>
<section id="estimate-zero-prices-for-149-unique-dates-with-304-bonds-of-bond-data-dataframe">
<h2>Estimate zero prices for 149 unique dates with 304 bonds of bond_data DataFrame<a class="headerlink" href="#estimate-zero-prices-for-149-unique-dates-with-304-bonds-of-bond-data-dataframe" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># apply the accrued_interest function to the DataFrame</span>
<span class="n">bond_data</span><span class="p">[</span><span class="s1">&#39;Accrued&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bond_data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">accrued_interest</span><span class="p">(</span>
        <span class="n">maturity</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="c1"># Assuming index is maturity</span>
        <span class="n">coupon</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;Coupon&#39;</span><span class="p">],</span>
        <span class="n">settlement</span><span class="o">=</span><span class="n">settlement</span><span class="p">,</span>
        <span class="n">freq</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">day_type</span><span class="o">=</span><span class="s1">&#39;Actual/Actual&#39;</span>
    <span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>

<span class="c1"># Calculate transaction prices</span>
<span class="n">transaction_prices</span><span class="o">=</span><span class="p">((</span><span class="n">bond_data</span><span class="p">[</span><span class="s1">&#39;Price Bid&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">bond_data</span><span class="p">[</span><span class="s1">&#39;Price Ask&#39;</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span>
                    <span class="n">bond_data</span><span class="p">[</span><span class="s1">&#39;Accrued&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

<span class="c1"># Create payoff matrix</span>
<span class="n">payoffs_304</span><span class="p">,</span><span class="n">column_dates_304</span><span class="o">=</span><span class="n">create_payoff_matrix</span><span class="p">(</span><span class="n">bond_data</span><span class="p">,</span><span class="n">settlement</span><span class="o">=</span><span class="n">settlement</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Estimate the present value factors with least squares</span>
<span class="n">zero_prices_304</span><span class="p">,</span><span class="n">ss2_304</span><span class="p">,</span><span class="n">rank_304</span><span class="p">,</span><span class="n">colInfo_304</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">payoffs_304</span><span class="p">,</span><span class="n">transaction_prices</span><span class="p">)</span>

<span class="c1"># Maturity of the bonds in years</span>
<span class="n">maturity_years</span><span class="o">=</span><span class="p">[(</span><span class="n">mat_date</span><span class="o">-</span><span class="n">settlement</span><span class="p">)</span><span class="o">.</span><span class="n">days</span><span class="o">/</span><span class="mf">365.25</span> <span class="k">for</span> <span class="n">mat_date</span> <span class="ow">in</span> <span class="n">column_dates_304</span><span class="p">]</span>


<span class="c1"># Continuously compounded annualized spot rates</span>
<span class="n">spot_rates_304</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">zero_prices_304</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">maturity_years</span><span class="p">)</span>

<span class="c1"># Continuously compounded annualized forward rates</span>
<span class="n">forward_rates_304</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">zero_prices_304</span><span class="p">))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">maturity_years</span><span class="p">)</span>
<span class="n">forward_rates_304</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">forward_rates_304</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

<span class="c1"># Create a DataFrame of least squares present value estimates and display results</span>
<span class="c1"># First a dictionary</span>
<span class="n">bonds_304</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Zero Prices: 304&#39;</span><span class="p">:</span><span class="n">zero_prices_304</span><span class="p">,</span>
           <span class="s1">&#39;Spot Rates:304&#39;</span><span class="p">:</span><span class="n">spot_rates_304</span><span class="p">,</span>
           <span class="s1">&#39;Forward Rates: 304&#39;</span><span class="p">:</span><span class="n">forward_rates_304</span><span class="p">}</span>

<span class="c1"># Then a DataFrame</span>
<span class="n">df_304</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">bonds_304</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">column_dates_304</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_304</span><span class="p">)</span>

<span class="c1"># Create a DataFrame of summary statistics and display results</span>
<span class="c1"># First a dictionary</span>
<span class="n">summary_304</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Average Sum Squared Errors&#39;</span><span class="p">:</span><span class="n">ss2_304</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">bond_data</span><span class="p">),</span>
             <span class="s1">&#39;Payoff Rank&#39;</span><span class="p">:</span><span class="n">rank_304</span><span class="p">,</span>
             <span class="s1">&#39;Column Max Info&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">colInfo_304</span><span class="p">),</span>
             <span class="s1">&#39;Column Min Info&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">colInfo_304</span><span class="p">)}</span>
<span class="c1"># Then a DataFrame</span>
<span class="n">df_summary_304</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">summary_304</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Summary Statistics&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_summary_304</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_22904/2585489679.py:20: FutureWarning: `rcond` parameter will change to the default of machine precision times ``max(M, N)`` where M and N are the input matrix dimensions.
To use the future default and silence this warning we advise to pass `rcond=None`, to keep using the old, explicitly pass `rcond=-1`.
  zero_prices_304,ss2_304,rank_304,colInfo_304=np.linalg.lstsq(payoffs_304,transaction_prices)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Zero Prices: 304</th>
      <th>Spot Rates:304</th>
      <th>Forward Rates: 304</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2025-01-28</th>
      <td>0.999295</td>
      <td>0.036799</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2025-01-30</th>
      <td>0.999065</td>
      <td>0.037963</td>
      <td>0.042038</td>
    </tr>
    <tr>
      <th>2025-01-31</th>
      <td>0.998886</td>
      <td>0.040711</td>
      <td>0.065439</td>
    </tr>
    <tr>
      <th>2025-02-04</th>
      <td>0.998475</td>
      <td>0.039817</td>
      <td>0.037581</td>
    </tr>
    <tr>
      <th>2025-02-06</th>
      <td>0.998240</td>
      <td>0.040213</td>
      <td>0.042987</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2029-10-31</th>
      <td>0.812875</td>
      <td>0.043390</td>
      <td>0.043360</td>
    </tr>
    <tr>
      <th>2029-11-15</th>
      <td>0.809539</td>
      <td>0.043874</td>
      <td>0.100158</td>
    </tr>
    <tr>
      <th>2029-11-30</th>
      <td>0.809936</td>
      <td>0.043402</td>
      <td>-0.011943</td>
    </tr>
    <tr>
      <th>2029-12-31</th>
      <td>0.806965</td>
      <td>0.043400</td>
      <td>0.043302</td>
    </tr>
    <tr>
      <th>2030-01-31</th>
      <td>0.803448</td>
      <td>0.043536</td>
      <td>0.051455</td>
    </tr>
  </tbody>
</table>
<p>149 rows × 3 columns</p>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Summary Statistics</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Average Sum Squared Errors</th>
      <td>0.011753</td>
    </tr>
    <tr>
      <th>Payoff Rank</th>
      <td>149.000000</td>
    </tr>
    <tr>
      <th>Column Max Info</th>
      <td>267.431046</td>
    </tr>
    <tr>
      <th>Column Min Info</th>
      <td>100.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="the-304-bond-results">
<h2>The 304 bond results<a class="headerlink" href="#the-304-bond-results" title="Link to this heading">#</a></h2>
<p>There is a slight upward trend in the term structure between shortest maturity (three days) and five years. As was true for the eleven bonds, the ratio of the maximum and minimum column information values confirm that our estimates are, in fact, reliable.  Two forward rates, however, stand out.</p>
<section id="notable-forward-rate-estimates">
<h3>Notable forward rate estimates<a class="headerlink" href="#notable-forward-rate-estimates" title="Link to this heading">#</a></h3>
<p>Estimates for the last five dates show two striking results:</p>
<ol class="arabic simple">
<li><p><strong>An annualized forward rate of over 10%</strong> for the 15-day period between October 31<span class="math notranslate nohighlight">\(^{st}\)</span> to November 15<span class="math notranslate nohighlight">\(^{th}\)</span> 2029.</p></li>
<li><p><strong>A negative annualized forward rate of -1%</strong> for the subsequent 15 days,  November 15<span class="math notranslate nohighlight">\(^{th}\)</span> to November 30<span class="math notranslate nohighlight">\(^{th}\)</span>, 2029.</p></li>
</ol>
<p>Because the zero price on November 15<span class="math notranslate nohighlight">\(^{th}\)</span> 2029 is too high, the October 31<span class="math notranslate nohighlight">\(^{st}\)</span> spot rate is high and the forward rate for the next fifteen days is negative.</p>
<p>It is highly probable that there are other instances of negative estimates of forward rates. Negative estimates may be actual arbitrage opportunities or simply due to:</p>
<ul class="simple">
<li><p><strong>Non-Coincident Prices:</strong> Although the bond prices are downloaded simultaneously, it is unlikely they are updated at the exact same moment. Consequently, apparent arbitrage opportunities may simply be a reflection of stale pricing.</p></li>
<li><p><strong>Bid/Ask Spread:</strong> We use the average of the bid and ask prices as the quoted price. However, actual transactions involve a small cost, as we cannot buy and sell at the identical price.</p></li>
</ul>
<p>Below the estimated zero prices are used to value the 304 bonds.  That analysis shows larger pricing errors in the longer maturity bonds. There we discuss how these discrepancies would influence portfolio decisions.</p>
</section>
</section>
<section id="plot-least-squares-ols-zero-price-estimates-for-149-unique-dates">
<h2>Plot Least Squares (OLS) Zero Price Estimates for 149 unique dates<a class="headerlink" href="#plot-least-squares-ols-zero-price-estimates-for-149-unique-dates" title="Link to this heading">#</a></h2>
<p>The function <font color='green'>one_y_axis</font> of Chapter One is used to plot the zero prices derived from the 304 bonds. It is worth noting that a small number of these estimated zero prices are marginally higher than their preceding values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">settlement</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">21</span><span class="p">)</span>

<span class="c1"># Initialize a dictionary to hold plot-saving configurations.</span>
<span class="n">save_config</span><span class="o">=</span><span class="p">{}</span>

<span class="c1"># Calculate the time to maturity in years for each data point</span>
<span class="n">years</span><span class="o">=</span><span class="p">[(</span><span class="n">pay_date</span><span class="o">-</span><span class="n">settlement</span><span class="p">)</span><span class="o">.</span><span class="n">days</span><span class="o">/</span><span class="mf">365.25</span> <span class="k">for</span> <span class="n">pay_date</span> <span class="ow">in</span> <span class="n">column_dates_304</span><span class="p">]</span>

<span class="c1"># Initialize a dictionary to hold plot-saving configurations.</span>
<span class="n">save_config</span><span class="o">=</span><span class="p">{}</span>
<span class="n">string_date</span><span class="o">=</span><span class="s1">&#39;01/21/2025&#39;</span>

<span class="c1"># Set the x-axis and y-axis data for the plot.</span>
<span class="n">xaxis</span><span class="o">=</span><span class="n">years</span>              <span class="c1">#Maturity relative to 1/21/2025</span>
<span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">df_304</span><span class="p">[</span><span class="s1">&#39;Zero Prices: 304&#39;</span><span class="p">]]</span>       <span class="c1">#y-axis data</span>

<span class="c1"># Define the file name and folder for the saved plot.</span>


<span class="c1"># Attempt to extract the plot title from the file name.</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">save_config</span><span class="p">[</span><span class="s1">&#39;File Name&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
<span class="c1">#&#39;File&#39; key not found or string is too short), set a default title.</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Add A Title&#39;</span>

<span class="c1"># Define labels for the data series, y-axis, and x-axis.</span>
<span class="n">series</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Zero Prices&#39;</span><span class="p">]</span>
<span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Zero Prices&#39;</span>
<span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Maturity In Years&#39;</span>

<span class="c1"># Set plot aesthetics: marker styles, y-axis limits, figure size, and color.</span>
<span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&lt;&#39;</span><span class="p">]</span>
<span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">1.01</span><span class="p">]</span>
<span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="c1"># Define colors as red</span>
<span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">]</span>

<span class="c1"># Call the plotting function with all the prepared data and configurations</span>
<span class="n">one_y_axis</span><span class="p">(</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">series</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span> <span class="n">markers</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">ylim</span><span class="p">,</span>
           <span class="n">save_config</span><span class="o">=</span><span class="n">save_config</span><span class="p">,</span><span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/cf624695cf3875783f9a821b638f394aabbde97ad8f032f2bb096be336f3ad71.png" src="_images/cf624695cf3875783f9a821b638f394aabbde97ad8f032f2bb096be336f3ad71.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="pricing-bonds-with-zero-price-estimates">
<h1><em><strong>Pricing Bonds With Zero Price Estimates</strong></em><a class="headerlink" href="#pricing-bonds-with-zero-price-estimates" title="Link to this heading">#</a></h1>
<p>The zero price estimates can be used to price bonds with payment dates matching the dates of the zero price estimates.  Because the zero estimates are derived from the 304 bonds, the dates of the zero price and the bond payments match. The array of predicted bond prices equal:</p>
<div class="math notranslate nohighlight">
\[Predicted\ Prices=Payoff\ Array\times Zero\ Price\ Estimates\]</div>
<p>The array of pricing errors equals:</p>
<div class="math notranslate nohighlight">
\[Pricing\ Errors=Predicted\ Prices - Transaction\ Prices\]</div>
<p>The pricing errors, plotted against the bonds’ maturities, are generally less than twenty-five cents, though three errors are approximately fifty cents. These pricing discrepancies represent between 25 and 50 basis points relative to the bonds’ par value. Had these prices been executable, the errors indicate the potential for arbitrage profits.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicted_prices</span><span class="o">=</span><span class="n">payoffs_304</span><span class="nd">@zero_prices_304</span>
<span class="n">pricing_errors</span><span class="o">=</span><span class="n">predicted_prices</span><span class="o">-</span><span class="n">transaction_prices</span>
<span class="n">years</span><span class="o">=</span><span class="p">[(</span><span class="n">date_obj</span><span class="o">-</span><span class="n">settlement</span><span class="p">)</span><span class="o">.</span><span class="n">days</span><span class="o">/</span><span class="mf">365.25</span> <span class="k">for</span> <span class="n">date_obj</span> <span class="ow">in</span>
       <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">bond_data</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">]</span>
<span class="n">save_config</span><span class="o">=</span><span class="p">{}</span>
<span class="n">string_date</span><span class="o">=</span><span class="s1">&#39;01/21/2025&#39;</span>
<span class="n">xaxis</span><span class="o">=</span><span class="n">years</span>              <span class="c1">#Maturity relative to 1/21/2025</span>
<span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">pricing_errors</span><span class="p">]</span>       <span class="c1">#y-axis data</span>
<span class="c1"># Attempt to extract the plot title from the file name.</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">save_config</span><span class="p">[</span><span class="s1">&#39;File Name&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
<span class="c1">#&#39;File&#39; key not found or string is too short), set a default title.</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Add A Title&#39;</span>
<span class="n">series</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Pricing Errors&#39;</span><span class="p">]</span>
<span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;$ Pricing Error (Par Value 100)&#39;</span>
<span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Maturity In Years&#39;</span>
<span class="n">x</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&lt;&#39;</span><span class="p">]</span>
<span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.</span><span class="p">]</span>
<span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="n">colors</span><span class="o">=</span><span class="s1">&#39;r&#39;</span>
<span class="n">one_y_axis</span><span class="p">(</span><span class="n">xaxis</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">title</span><span class="p">,</span><span class="n">series</span><span class="p">,</span><span class="n">xlabel</span><span class="p">,</span><span class="n">ylabel</span><span class="p">,</span><span class="n">markers</span><span class="p">,</span><span class="n">size</span><span class="p">,</span><span class="n">ylim</span><span class="p">,</span>
           <span class="n">save_config</span><span class="o">=</span><span class="n">save_config</span><span class="p">,</span><span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/37e98059dc3126ffcebb3d53c3f81019f852421003760a1c6122892a4a195cf2.png" src="_images/37e98059dc3126ffcebb3d53c3f81019f852421003760a1c6122892a4a195cf2.png" />
</div>
</div>
<section id="how-would-investors-use-this-analysis">
<h2>How would investors use this analysis<a class="headerlink" href="#how-would-investors-use-this-analysis" title="Link to this heading">#</a></h2>
<p>The pricing errors quantify the relative value among the 304 bonds. Taken at face value, these errors suggest potential return enhancement for investors through the sale of overvalued bonds (indicated by negative pricing errors) and the purchase of undervalued bonds (indicated by positive pricing errors). An enhancement that could be achieved by:</p>
<ol class="arabic simple">
<li><p><strong>An Arbitrage Trade:</strong> Executing trades designed to capture profit with minimal or no risk.</p></li>
<li><p><strong>A Quasi-Arbitrage Trade (Portfolio Tilting):</strong> Adjusting portfolios by decreasing exposure to overvalued bonds and increasing exposure to undervalued bonds.</p></li>
</ol>
<p>Both strategies require effective control of the risks associated with the return-enhancing trades. For bonds like those issued by the U.S. Treasury with low default risk, the most critical risk is unexpected changes in interest rates. Although the concept is intuitively linked to present value factors, the specific methods for measuring this interest rate risk—duration and convexity—are detailed in two forthcoming chapters.</p>
</section>
<section id="chapter-exercise">
<h2><span style="text-align: left; color:green; font-family: 'Franklin Gothic Medium', sans-serif; margin-top: 1.0em; margin-bottom: 0em; font-style: italic;">Chapter Exercise</span><a class="headerlink" href="#chapter-exercise" title="Link to this heading">#</a></h2>
<p><span style="text-align: left; color:green; font-family: 'Franklin Gothic Medium', sans-serif; margin-top: 0; margin-bottom: 0.5em; font-style: italic;
"><big>Using the term structure calculated with 304 bonds</big>
</span></p>
<p>Calculate the forward rates for the following dates.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Start Date</p></th>
<th class="head"><p>End Date</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>   January 28<span class="math notranslate nohighlight">\(^{th}\)</span> 2025</p></td>
<td><p>   February 2<span class="math notranslate nohighlight">\(^{nd}\)</span> 2026</p></td>
</tr>
<tr class="row-odd"><td><p>   February 2<span class="math notranslate nohighlight">\(^{nd}\)</span> 2026</p></td>
<td><p>   February 1<span class="math notranslate nohighlight">\(^{st}\)</span> 2027</p></td>
</tr>
<tr class="row-even"><td><p>   February 1<span class="math notranslate nohighlight">\(^{st}\)</span> 2027</p></td>
<td><p>   January 31<span class="math notranslate nohighlight">\(^{st}\)</span> 2028</p></td>
</tr>
<tr class="row-odd"><td><p>   January 31<span class="math notranslate nohighlight">\(^{st}\)</span> 2028</p></td>
<td><p>   January 31<span class="math notranslate nohighlight">\(^{st}\)</span> 2030</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
<p>see <a class="reference external" href="https://colab.research.google.com/drive/1hSV2ArS-kEm3soW-sbIBTjWnnD3nMvkh#scrollTo=gTwsGdLgxMCB">Chapter Four Hints: Using 304 bond term structure estimates</a>, and check the <a class="reference external" href="https://colab.research.google.com/drive/1hrv5WQPxxuto7jIy1I6_fdyeAyhNCLaY#scrollTo=gTwsGdLgxMCB">expected results here</a>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "PatrickJHess/Vol-3-Chap-4",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Creating_The_Payoff_Matrix.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Creating the payoff matrix</p>
      </div>
    </a>
    <a class="right-next"
       href="imported_functions_Four.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Function Imported by Chapter Four.</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Bootstrapping the term structure with 304 bonds</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#this-notebook-calculates-the-term-structure-of-interest-rates-for-304-coupon-bonds-it-utilizes-the-function-developed-in-chapters-two-and-three-as-well-as-the-using-the-linalg-module-of-numpy-and-creating-the-payoff-matrix-notebooks-from-this-chapter-the-necessary-functions-are-imported-from-a-custom-module-demonstrating-the-ability-to-skip-their-development-and-leapfrog-over-previous-chapters-and-notebooks">This notebook calculates the term structure of interest rates for 304 coupon bonds. It utilizes the function developed in Chapters Two and Three, as well as the <em>Using the linalg module of NumPy</em> and <em>Creating the payoff matrix</em> notebooks from this chapter. The necessary functions are imported from a custom module, demonstrating the ability to skip their development and “leapfrog” over previous chapters and notebooks.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-libraries-modules-and-functions">Importing libraries, modules, and functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#as-in-earlier-chapters-of-the-volume-modules-that-are-included-in-the-standard-python-library-are-imported-when-necessary-other-modules-or-libraries-are-installed-before-they-are-imported">As in earlier chapters of the volume, modules that are included in the standard Python library are imported. When necessary, other modules or libraries are installed before they are imported.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-a-custom-module-and-importing-functions">Adding a custom module and importing functions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-used-to-estimate-the-term-structure">Data Used To Estimate The Term Structure</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-read-excel-method-converts-the-workbook-sheet-into-a-pandas-dataframe-and-requires-a-url-address-here-the-index-of-the-dataframe-is-assigned-the-first-column-of-the-sheet-and-the-sheet-is-identified-as-fidelity-data">The <font color="green">read_excel()</font> method converts the workbook sheet into a Pandas DataFrame and requires a URL address.  Here the index of the DataFrame is assigned the first column of the sheet and the sheet is identified as ‘Fidelity Data’.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#identifying-bonds-that-mature-on">Identifying bonds that mature On:</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-code-segment-works-as-follows">The code segment works as follows:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-eleven-bond-example-of-the-notebook-creating-the-payoff-matrix">The eleven bond example of the notebook <em>Creating the payoff matrix</em>.</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-the-payoff-matrix-for-the-eleven-bonds">Create the payoff matrix for the eleven bonds.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#displaying-the-payoff-array-of-sample-bonds-as-a-pandas-dataframe">Displaying the payoff array of sample_bonds as a Pandas DataFrame.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#application-determine-the-payoff-matrix-for-the-first-twenty-bonds-in-bond-data-datafame"><font color="green">Application: Determine the payoff matrix for the first twenty bonds in bond_data DataFame</font></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimate-zero-prices-for-the-five-unique-dates-of-the-sample-bonds-dataframe">Estimate zero prices for the five unique dates of the sample_bonds DataFrame</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-accrued-interest-and-transaction-prices">Calculating accrued interest and transaction prices</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-the-lstsq-of-linalg-module-of-numpy-library">Use the <font color="green">lstsq</font> of linalg module of NumPy library</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-eleven-bond-results">The eleven bond results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#application-estimate-the-term-structure-with-the-first-twenty-five-bonds"><font color="green">Application: Estimate the term structure with the first twenty five bonds</font></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#see-chapter-three-hints-payoff-matrix-first-20-bonds-and-check-the-expected-results-here">see Chapter Three Hints: payoff matrix first 20 bonds and check the expected results here.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimate-zero-prices-for-149-unique-dates-with-304-bonds-of-bond-data-dataframe">Estimate zero prices for 149 unique dates with 304 bonds of bond_data DataFrame</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-304-bond-results">The 304 bond results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#notable-forward-rate-estimates">Notable forward rate estimates</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-least-squares-ols-zero-price-estimates-for-149-unique-dates">Plot Least Squares (OLS) Zero Price Estimates for 149 unique dates</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#pricing-bonds-with-zero-price-estimates"><em><strong>Pricing Bonds With Zero Price Estimates</strong></em></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-would-investors-use-this-analysis">How would investors use this analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chapter-exercise"><span style="text-align: left; color:green; font-family: 'Franklin Gothic Medium', sans-serif; margin-top: 1.0em; margin-bottom: 0em; font-style: italic;">Chapter Exercise</span></a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Financial Python
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025 by Arbitrage Partners..
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>