
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Using the linalg module of NumPy &#8212; Basic Concepts of Fixed Income: Bootstrapping the Term Structure with a Few Hundred Bonds</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Using_the_linalg_module_of_NumPy';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Creating the payoff matrix" href="Creating_The_Payoff_Matrix.html" />
    <link rel="prev" title="Inferring zero prices from the present value function" href="Inferring_Zero_Prices.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Basic Concepts of Fixed Income: Bootstrapping the Term Structure with a Few Hundred Bonds</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Financial Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Interacting%20With%20Jupyter%20Books.html">Working with Jupyter Books</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Basic Concepts of Fixed Income: Chapter Four</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="Chapter_Four_Highlights.html">Bootstrapping The Term Structure With A Few Hundred Bonds</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Inferring_Zero_Prices.html"><strong>Inferring zero prices from the present value function</strong></a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Using the linalg module of NumPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="Creating_The_Payoff_Matrix.html">Creating the payoff matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="Bootstrapping_The_Term_Structure_With_304_Bonds.html">Bootstrapping the term structure with 304 bonds</a></li>

<li class="toctree-l2"><a class="reference internal" href="imported_functions_Four.html">Function Imported by Chapter Four.</a></li>
</ul><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/PatrickJHess/Vol-3-Chap-4/master?urlpath=tree/Using_the_linalg_module_of_NumPy.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/PatrickJHess/Vol-3-Chap-4/blob/master/Using_the_linalg_module_of_NumPy.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>



<a href="https://github.com/PatrickJHess/Vol-3-Chap-4/issues/new?title=Issue%20on%20page%20%2FUsing_the_linalg_module_of_NumPy.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button"
   title="Open an issue"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Using_the_linalg_module_of_NumPy.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Using the linalg module of NumPy</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-numpy">Import NumPy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#check-the-rank-of-payoffs-two-bonds-to-determine-if-it-is-invertible">Check the rank of <font color="green">payoffs_two_bonds</font> to determine if it is invertible</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#demonstrating-the-matrix-rank-function">Demonstrating the <font color="green">matrix_rank</font> function.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#application-find-the-rank-of-non-square-two-dimensional-array"><font color="green">Application: Find the rank of non-square two-dimensional array</font></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-function-check-rank-tests-if-a-numpy-array-has-full-column-rank">The function <font color="green">check_rank</font> tests if a NumPy array has full column rank.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#two-equations-and-two-unknowns-the-exact-solution">Two equations and two unknowns: the exact solution.</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-payoff-matrix-prices-and-full-rank-of-payoff-matrix">Define the payoff matrix. prices, and full rank of payoff matrix.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#get-the-inverse-of-the-payoffs-two-bond-array-with-the-linalg-module">Get the inverse of the <font color="green">payoffs_two_bond</font> array with the linalg module.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-present-value-factors-or-zero-prices">Calculate the present value factors or zero prices</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-linalg-function-solve">The linalg function <font color="green">solve</font></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-three-bond-least-squares-solution">The three bond least-squares solution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Define the payoff matrix. prices, and full rank of payoff matrix.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-transpose-of-payoffs-three-bonds-with-transpose-attribute-of-numpy-arrays">Calculate the transpose of <font color="green">payoffs_three_bonds</font> with transpose attribute of NumPy arrays.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-and-display-multiplying-transpose-into-original-matrix-and-into-price-matrix">Calculate and display multiplying transpose into original matrix and into price matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solve-for-present-value-factors">Solve for present value factors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-linalg-function-lstsq">The linalg function <font color="green">lstsq</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-lstsq-function-returns-four-values">The <font color="green">lstsq</font> function returns four values:</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="using-the-linalg-module-of-numpy">
<h1>Using the linalg module of NumPy<a class="headerlink" href="#using-the-linalg-module-of-numpy" title="Link to this heading">#</a></h1>
<section id="import-numpy">
<h2>Import NumPy<a class="headerlink" href="#import-numpy" title="Link to this heading">#</a></h2>
<p>Bootstrapping the term structure requires us to invert and multiple matrices and arrays-common operations of linear algebra.  The NumPy module <font color='green'>linalg</font> includes functions that manipulate matrices and arrays. This notebook uses the module to demonstrate the bootstrapping applications detailed in <em>Inferring zero prices from the present value function</em>. The initial step is to import the NumPy library. The standard <font color='green'>try</font> and <font color='green'>except</font> is used to import the library.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Need to import NumPy</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># install if necessary</span>
<span class="k">except</span><span class="p">:</span>
    <span class="o">!</span>pip<span class="w"> </span>-q<span class="w"> </span>install<span class="w"> </span>numpy
    <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="check-the-rank-of-payoffs-two-bonds-to-determine-if-it-is-invertible">
<h2>Check the rank of <font color='green'>payoffs_two_bonds</font> to determine if it is invertible<a class="headerlink" href="#check-the-rank-of-payoffs-two-bonds-to-determine-if-it-is-invertible" title="Link to this heading">#</a></h2>
<p>The payoff matrices in, <em>Inferring zero prices from the present value function</em>, include data columns for both six months and one year. Inspection reveals that both columns contribute unique information—a condition that may not hold when this approach is expanded to include multiple bonds.</p>
<p>A critical issue arises if a date’s column offers no incremental information: the payoff matrix, or the product of its transpose and the payoff matrix, are non-invertible or singular and a solution cannot be calculated. Although obvious in our two-date examples, a general procedure is needed to test for unique information in each column.</p>
<p>The rank of a matrix is defined by the number of columns that cannot be reproduced by a linear combination of the other columns. For our two-date examples, we need two independent columns or a rank of two. The <font color='green'>linalg matrix_rank</font> function returns the number of independent columns.</p>
</section>
<section id="demonstrating-the-matrix-rank-function">
<h2>Demonstrating the <font color='green'>matrix_rank</font> function.<a class="headerlink" href="#demonstrating-the-matrix-rank-function" title="Link to this heading">#</a></h2>
<p>The next code cell creates a three column matrix, but the third column equals the first column plus the second column. Column three adds no new information.  The rank of the matrix is two.</p>
<ul class="simple">
<li><p>The <font color='green'> matrix_a</font>. is created.</p></li>
<li><p>The linalg function <font color='green'>matrix_rank</font> returns two as the rank of <font color='green'> matrix_a</font>.</p></li>
<li><p>The number of rows and columns of <font color='green'> matrix_a</font> is returned with the <font color='green'> shape</font> attribute.</p></li>
<li><p>Invertibility is determined by testing the equality of <font color='green'> num_columns_a</font> and <font color='green'> rank_a</font></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the NumPy two-dimensional array</span>
<span class="n">matrix_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">]])</span>

<span class="c1"># Determine the rank with matrix_rank function</span>
<span class="n">rank_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_rank</span><span class="p">(</span><span class="n">matrix_a</span><span class="p">)</span>

<span class="c1"># Compare number of columns to rank</span>
<span class="c1"># shape attribute returns a tuple (number of rows,number of columns)</span>
<span class="n">num_row_a</span><span class="p">,</span><span class="n">num_columns_a</span><span class="o">=</span><span class="n">matrix_a</span><span class="o">.</span><span class="n">shape</span>

<span class="c1"># Test for invertibility</span>
<span class="n">invertible</span><span class="o">=</span><span class="n">num_columns_a</span><span class="o">==</span><span class="n">rank_a</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Is matrix_a invertible?: </span><span class="si">{</span><span class="n">invertible</span><span class="si">}</span><span class="s2">--&#39;Number of columns: </span><span class="si">{</span><span class="n">num_columns_a</span><span class="si">}</span><span class="se">\</span>
<span class="s2">---Rank of a: </span><span class="si">{</span><span class="n">rank_a</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Is matrix_a invertible?: False--&#39;Number of columns: 3---Rank of a: 2
</pre></div>
</div>
</div>
</div>
</section>
<section id="application-find-the-rank-of-non-square-two-dimensional-array">
<h2><font color='green'>Application: Find the rank of non-square two-dimensional array</font><a class="headerlink" href="#application-find-the-rank-of-non-square-two-dimensional-array" title="Link to this heading">#</a></h2>
<div style="
    border-left: 12px solid green;
    line-height: 1.5;
    padding: 15px">
<br>
<p>Calculate the rank of the array:</p>
<p><span class="math notranslate nohighlight">\(\begin{pmatrix}
1&amp;10&amp;5  \\
2 &amp;102&amp;25  \\
\end{pmatrix}\)</span></p>
<p>For hints, see <a class="reference external" href="https://patrickjhess.github.io/Hints-Results/Chapter_Four_Hints.html#application-find-the-rank-of-non-square-two-dimensional-array">Chapter Four Hints: Non-square two-dimensional array</a>,  and check the <a class="reference external" href="https://patrickjhess.github.io/Hints-Results/Chapter_Four_Results.html#application-find-the-rank-of-non-square-two-dimensional-array">expected results here</a>.</p>
<br>
</div>
</section>
<section id="the-function-check-rank-tests-if-a-numpy-array-has-full-column-rank">
<h2>The function <font color='green'>check_rank</font> tests if a NumPy array has full column rank.<a class="headerlink" href="#the-function-check-rank-tests-if-a-numpy-array-has-full-column-rank" title="Link to this heading">#</a></h2>
<ul>
<li><p><span class="math notranslate nohighlight">\(\text{rank of matrix} \leq \min(\text{number of rows},\text{number of columns})\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\text{rank of rows} = \text{rank of columns}\)</span></p></li>
<li><h5 class="rubric" id="input-must-be-a-numpy-array">Input must be a NumPy array</h5>
</li>
<li><h5 class="rubric" id="shape-attribute-returns-number-of-rows-number-of-columns"><font color='green'>shape</font> attribute returns (number of rows,number of columns).</h5>
</li>
<li><h5 class="rubric" id="matrix-rank-function-returns-number-of-indpendent-columns"><font color='green'>matrix_rank</font> function returns number of indpendent columns.</h5>
</li>
<li><h5 class="rubric" id="function-returns-independent-columns-the-truth-value-of-equality-of-rank-and-number-of-columns">function returns <font color='green'>independent_columns</font>-the truth value of equality of rank and number of columns.</h5>
</li>
</ul>
<br>
<p>If the number of rows exceeds the number of columns, the rows of a matrix may be linearly dependent.  An important result when bootstrapping the term structure with more bonds (rows) than dates (columns).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">check_rank</span><span class="p">(</span><span class="n">array</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  Checks if a matrix has Full Column Rank (all columns are linearly independent).</span>

<span class="sd">    Args:</span>
<span class="sd">        array (np.ndarray): The matrix to check.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if all columns are independent, False if there is redundancy.</span>
<span class="sd">  &#39;&#39;&#39;</span>
  <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
  <span class="c1"># Validate input</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">array</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Input must be a NumPy array.&quot;</span><span class="p">)</span>

  <span class="c1"># Get number of columns and rows</span>
  <span class="c1"># Full column rank implies that number of rows &gt;= number of columns</span>
  <span class="n">array_rows</span><span class="p">,</span><span class="n">array_columns</span><span class="o">=</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span>
  <span class="k">if</span> <span class="n">array_rows</span><span class="o">&lt;</span><span class="n">array_columns</span><span class="p">:</span>
    <span class="k">return</span> <span class="kc">False</span>

  <span class="c1"># Calculate rank</span>
  <span class="n">array_rank</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_rank</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>


  <span class="c1"># If is_full_rank  true, least-squares or exact solutions possible</span>
  <span class="n">is_full_rank</span><span class="o">=</span><span class="n">array_columns</span><span class="o">==</span><span class="n">array_rank</span>
  <span class="k">return</span> <span class="n">is_full_rank</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="two-equations-and-two-unknowns-the-exact-solution">
<h2>Two equations and two unknowns: the exact solution.<a class="headerlink" href="#two-equations-and-two-unknowns-the-exact-solution" title="Link to this heading">#</a></h2>
<p>The first example of <em>Inferring zero prices from the present value function</em> has two dates and two bonds.  An exact solution is possible.</p>
<ol class="arabic simple">
<li><p>The payoff matrix <font color='green'>payoffs_two_bonds</font> and the bond price vector <font color='green'>prices_two_bonds</font> are defined.</p></li>
<li><p>The full column rank of <font color='green'>payoffs_two_bonds</font> is verified with the <font color='green'>check_rank</font> function.</p></li>
</ol>
<section id="define-the-payoff-matrix-prices-and-full-rank-of-payoff-matrix">
<h3>Define the payoff matrix. prices, and full rank of payoff matrix.<a class="headerlink" href="#define-the-payoff-matrix-prices-and-full-rank-of-payoff-matrix" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the payoff matrix (two-dimensional array) for the two bond example</span>
<span class="n">payoffs_two_bonds</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">100</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>  <span class="c1">#six month bond</span>
                           <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">102</span><span class="p">]])</span>  <span class="c1">#one-year coupon bond</span>

<span class="c1"># Define the price array for the two bond example</span>
<span class="n">prices_two_bonds</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">97.5</span><span class="p">,</span>      <span class="c1">#six month bond</span>
                           <span class="mi">100</span><span class="p">])</span>      <span class="c1">#one-year coupon bond</span>

<span class="c1">#Verify the rank of the payoff matrix</span>
<span class="n">full_rank</span><span class="o">=</span><span class="n">check_rank</span><span class="p">(</span><span class="n">payoffs_two_bonds</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Payoff matrix is full rank?  </span><span class="si">{</span><span class="n">full_rank</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Payoff matrix is full rank?  True
</pre></div>
</div>
</div>
</div>
</section>
<section id="get-the-inverse-of-the-payoffs-two-bond-array-with-the-linalg-module">
<h3>Get the inverse of the <font color='green'>payoffs_two_bond</font> array with the linalg module.<a class="headerlink" href="#get-the-inverse-of-the-payoffs-two-bond-array-with-the-linalg-module" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The function <font color='green'>inv</font> of linalg returns the inverse</p></li>
<li><p>The inverse is verified by multiplying the inverse and the original array with the NumPy <font color='green'>dot</font> function.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use inv function of linalg module to calculate inverse and display result</span>
<span class="n">payoffs_two_bond_inverse</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">payoffs_two_bonds</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Inverse of payoffs_two_bonds </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">payoffs_two_bond_inverse</span><span class="p">)</span>

<span class="c1"># Use dot function to multiply the inverse and original matrix and display results</span>
<span class="c1"># The product of a matrix and its inverse equals an identity</span>
<span class="c1"># matrix (one&#39;s on the main diagonal and zeroes elsewhere).</span>
<span class="n">should_be_identity</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">payoffs_two_bond_inverse</span><span class="p">,</span><span class="n">payoffs_two_bonds</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Inverse multiplied into payoffs_two_bond: Main diagonal 1 all other zero </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">should_be_identity</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Inverse of payoffs_two_bonds 
 [[ 0.01        0.        ]
 [-0.00019608  0.00980392]]
Inverse multiplied into payoffs_two_bond: Main diagonal 1 all other zero 
 [[1. 0.]
 [0. 1.]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculate-the-present-value-factors-or-zero-prices">
<h3>Calculate the present value factors or zero prices<a class="headerlink" href="#calculate-the-present-value-factors-or-zero-prices" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Multiply the payoff inverse and bond price vector to get the present value factors (zero prices) using the <font color='green'>dot</font> function.</p></li>
<li><p>Multiply the payoff matrix and present value factors to get the bond prices.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate and display two bond present value factors</span>

<span class="c1"># Multiple inverse of payoff and bond prices</span>
<span class="n">present_value_factors_two_bonds</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">payoffs_two_bond_inverse</span><span class="p">,</span><span class="n">prices_two_bonds</span><span class="p">)</span>
<span class="c1"># Display present value factors</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Present Value Factors&#39;</span><span class="p">,</span><span class="n">present_value_factors_two_bonds</span><span class="p">)</span>

<span class="c1"># Confirm present value factors by confirming bond prices</span>
<span class="c1"># Multiply payoffs into present value factors</span>
<span class="n">calculated_two_bond_prices</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">payoffs_two_bonds</span><span class="p">,</span><span class="n">present_value_factors_two_bonds</span><span class="p">)</span>
<span class="c1"># Display results</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Payoffs Times Present Value Factors&#39;</span><span class="p">,</span><span class="n">calculated_two_bond_prices</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Present Value Factors [0.975      0.96127451]
Payoffs Times Present Value Factors [ 97.5 100. ]
</pre></div>
</div>
</div>
</div>
</section>
<section id="the-linalg-function-solve">
<h3>The linalg function <font color='green'>solve</font><a class="headerlink" href="#the-linalg-function-solve" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Solving for the present value factors with the functions <font color='green'>inv</font> and <font color='green'>dot</font> requires two lines of code</p>
<ul>
<li><p><font color='green'>payoffs_two_bond_inverse=np.linalg.inv(payoffs_two_bonds)</p></li>
<li><p>present_value_factors_two_bonds=np.dot(payoffs_two_bond_inverse,prices_two_bonds)</font></p></li>
</ul>
</li>
<li><p>Solving for present value factors with linalg function <font color='green'>solve</font> takes one line of code.</p>
<ul>
<li><p><font color='green'>present_value_factors_two_bonds=np.linalg.solve(payoffs_two_bonds,prices_two_bonds)</font></p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">present_value_factors_two_bonds</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">payoffs_two_bonds</span><span class="p">,</span><span class="n">prices_two_bonds</span><span class="p">)</span>
<span class="n">present_value_factors_two_bonds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.975     , 0.96127451])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="the-three-bond-least-squares-solution">
<h2>The three bond least-squares solution<a class="headerlink" href="#the-three-bond-least-squares-solution" title="Link to this heading">#</a></h2>
<p>The second example of <em>Inferring zero prices from the present value function</em> has two dates and three bonds.  An exact solution is not possible; however, the payoff matrix has full column rank and the present value factors are solved with the least-squares method.</p>
<ol class="arabic simple">
<li><p>The payoff matrix <font color='green'>payoffs_three_bonds</font> and the bond price vector <font color='green'>prices_three_bonds</font> are defined.</p></li>
<li><p>The full column rank of <font color='green'>payoffs_three_bonds</font> is verified with the <font color='green'>check_rank</font> function.</p></li>
</ol>
<section id="id1">
<h3>Define the payoff matrix. prices, and full rank of payoff matrix.<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#the payoff and bond price matrixes are defined</span>
<span class="n">payoffs_three_bonds</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">100</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>    <span class="c1"># six-month bond</span>
                             <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">102</span><span class="p">],</span>     <span class="c1"># one-year coupon bond</span>
                              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">]])</span>   <span class="c1"># one-year zero-coupon bond</span>

<span class="n">prices_three_bonds</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">97.5</span><span class="p">,</span>          <span class="c1"># six-month bond</span>
                           <span class="mi">100</span><span class="p">,</span>           <span class="c1">#one-year coupon bond</span>
                           <span class="mi">96</span><span class="p">])</span>           <span class="c1">#one-year zero-coupon bond</span>

<span class="c1">#Verify the rank of the payoff matrix with check_rank function</span>
<span class="n">full_rank</span><span class="o">=</span><span class="n">check_rank</span><span class="p">(</span><span class="n">payoffs_three_bonds</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Payoff matrix is full rank?  </span><span class="si">{</span><span class="n">full_rank</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Payoff matrix is full rank?  True
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculate-the-transpose-of-payoffs-three-bonds-with-transpose-attribute-of-numpy-arrays">
<h3>Calculate the transpose of <font color='green'>payoffs_three_bonds</font> with transpose attribute of NumPy arrays.<a class="headerlink" href="#calculate-the-transpose-of-payoffs-three-bonds-with-transpose-attribute-of-numpy-arrays" title="Link to this heading">#</a></h3>
<p>The easiest way to get the transpose of a NumPy array is to get its transpose attribute with .T</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Assign the transpose attribute .T to payoffs_three_bonds</span>
<span class="n">payoffs_three_bonds_transpose</span><span class="o">=</span><span class="n">payoffs_three_bonds</span><span class="o">.</span><span class="n">T</span>

<span class="c1"># Display the original and transposed arrays</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The original array </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">payoffs_three_bonds</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The transposed array </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">payoffs_three_bonds_transpose</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The original array 
 [[100   0]
 [  2 102]
 [  0 100]]
The transposed array 
 [[100   2   0]
 [  0 102 100]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculate-and-display-multiplying-transpose-into-original-matrix-and-into-price-matrix">
<h3>Calculate and display multiplying transpose into original matrix and into price matrix<a class="headerlink" href="#calculate-and-display-multiplying-transpose-into-original-matrix-and-into-price-matrix" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Multiplication of the transpose of <font color='green'>payoffs_three_bonds</font> into the original payoff matrix. Using the <font color='green'>dot</font> function.</p></li>
<li><p>Multiplication of transpose of payoff matrix into the price array, <font color='green'>prices_three_bonds</font>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Using dot function to multiply transpose into original payoff matrix</span>
<span class="n">three_payoff_transpose_original</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">payoffs_three_bonds_transpose</span><span class="p">,</span><span class="n">payoffs_three_bonds</span><span class="p">)</span>

<span class="c1"># display results</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Multiplying Transpose of payoff matrix into payoff matrix </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">three_payoff_transpose_original</span><span class="p">)</span>

<span class="c1"># Use dot function to multiply transpose into prices_three_bonds</span>
<span class="n">three_payoff_transpose_prices</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">payoffs_three_bonds_transpose</span><span class="p">,</span><span class="n">prices_three_bonds</span><span class="p">)</span>
<span class="c1"># display result</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Multiplying Transpose of payoff matrix into three bond price array </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">three_payoff_transpose_prices</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Multiplying Transpose of payoff matrix into payoff matrix 
 [[10004   204]
 [  204 20404]]
Multiplying Transpose of payoff matrix into three bond price array 
 [ 9950. 19800.]
</pre></div>
</div>
</div>
</div>
</section>
<section id="solve-for-present-value-factors">
<h3>Solve for present value factors<a class="headerlink" href="#solve-for-present-value-factors" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Use <font color='green'>inv</font> function to invert the product of the transpose and the original payoff matrix.</p></li>
<li><p>Multiply the inverse into the product of the transpose of the payoff matrix and the three bond price array.</p></li>
<li><p>Display the least-square estimates of the present value factors.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inverse_transpose_original</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">three_payoff_transpose_original</span><span class="p">)</span>
<span class="n">least_square_pv_factors</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">inverse_transpose_original</span><span class="p">,</span><span class="n">three_payoff_transpose_prices</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Least-Squares PV Three Bonds </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">least_square_pv_factors</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Least-Squares PV Three Bonds 
 [0.97501274 0.96064975]
</pre></div>
</div>
</div>
</div>
<p>The estimated present value factors differ slightly from the factors derived using the payoffs and prices of two bonds. The small differences suggests that the third bond adds little to the information set.</p>
</section>
<section id="the-linalg-function-lstsq">
<h3>The linalg function <font color='green'>lstsq</font><a class="headerlink" href="#the-linalg-function-lstsq" title="Link to this heading">#</a></h3>
<p>The <font color='green'>lstsq</font> function requires a payoff matrix and price array. The function returns the estimated present value factors, the sum of the squared differences between the bond prices and the prices forecasted by the estimated factors, the column rank of the payoff matrix, and a measure of the information content of each column of the payoff matrix is close to having less than full rank.  Our purpose is to estimate the present value factors.</p>
<ul class="simple">
<li><p>Solving for the present value factors with the functions <font color='green'>inv</font> and <font color='green'>dot</font> requires five lines of code</p>
<ul>
<li><p><font color='green'>payoffs_three_bonds_transpose=payoffs_three_bonds.T</p></li>
<li><p>three_payoff_transpose_original=np.dot(payoffs_three_bonds_transpose,payoffs_three_bonds)</p></li>
<li><p>three_payoff_transpose_prices=np.dot(payoffs_three_bonds_transpose,prices_three_bonds)</p></li>
<li><p>inverse_transpose_original=np.linalg.inv(three_payoff_transpose_original)</p></li>
<li><p>least_square_pv_factors=np.dot(inverse_transpose_original,three_payoff_transpose_prices)</font></p></li>
</ul>
</li>
<li><p>Solving for present value factors with linalg function <font color='green'>lstsq</font> takes one line of code.</p>
<ul>
<li><p><font color='green'>least_square_pv_factors=np.linalg.lstsq(payoffs_three_bonds,prices_three_bonds)</font></p></li>
</ul>
</li>
</ul>
</section>
<section id="the-lstsq-function-returns-four-values">
<h3>The <font color='green'>lstsq</font> function returns four values:<a class="headerlink" href="#the-lstsq-function-returns-four-values" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>The estimated present value factors</p></li>
<li><p>The sum of the squared differences between the actual bond prices and those computed with the estimated present value factors.</p></li>
<li><p>The rank of the payoff matrix.</p></li>
<li><p>A measure of how much information content of each column. The ratio of the largest to the smallest indicate the information content of the columns of the matrix.</p></li>
</ol>
<p>Our concern is the estimated present value factors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">least_square_pv_factors</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">payoffs_three_bonds</span><span class="p">,</span><span class="n">prices_three_bonds</span><span class="p">)</span>
<span class="n">results</span><span class="o">=</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Six-month present value factor--</span><span class="si">{</span><span class="n">least_square_pv_factors</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1"> .4f</span><span class="si">}</span><span class="se">\</span>
<span class="s1">   One-year present value factor---</span><span class="si">{</span><span class="n">least_square_pv_factors</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1"> .4f</span><span class="si">}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="sa">f</span><span class="s1">&#39;Sum of squared differences---</span><span class="si">{</span><span class="n">least_square_pv_factors</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1"> .4f</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="sa">f</span><span class="s1">&#39;Column rank of payoff matrix---</span><span class="si">{</span><span class="n">least_square_pv_factors</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="sa">f</span><span class="s1">&#39;Information content of each column--</span><span class="si">{</span><span class="n">least_square_pv_factors</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Six-month present value factor-- 0.9750   One-year present value factor--- 0.9606 
Sum of squared differences--- 0.0083
Column rank of payoff matrix---2
Information content of each column--[142.85657143 100.        ]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_28250/1878391595.py:1: FutureWarning: `rcond` parameter will change to the default of machine precision times ``max(M, N)`` where M and N are the input matrix dimensions.
To use the future default and silence this warning we advise to pass `rcond=None`, to keep using the old, explicitly pass `rcond=-1`.
  least_square_pv_factors=np.linalg.lstsq(payoffs_three_bonds,prices_three_bonds)
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "PatrickJHess/Vol-3-Chap-4",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Inferring_Zero_Prices.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>Inferring zero prices from the present value function</strong></p>
      </div>
    </a>
    <a class="right-next"
       href="Creating_The_Payoff_Matrix.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Creating the payoff matrix</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-numpy">Import NumPy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#check-the-rank-of-payoffs-two-bonds-to-determine-if-it-is-invertible">Check the rank of <font color="green">payoffs_two_bonds</font> to determine if it is invertible</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#demonstrating-the-matrix-rank-function">Demonstrating the <font color="green">matrix_rank</font> function.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#application-find-the-rank-of-non-square-two-dimensional-array"><font color="green">Application: Find the rank of non-square two-dimensional array</font></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-function-check-rank-tests-if-a-numpy-array-has-full-column-rank">The function <font color="green">check_rank</font> tests if a NumPy array has full column rank.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#two-equations-and-two-unknowns-the-exact-solution">Two equations and two unknowns: the exact solution.</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-payoff-matrix-prices-and-full-rank-of-payoff-matrix">Define the payoff matrix. prices, and full rank of payoff matrix.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#get-the-inverse-of-the-payoffs-two-bond-array-with-the-linalg-module">Get the inverse of the <font color="green">payoffs_two_bond</font> array with the linalg module.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-present-value-factors-or-zero-prices">Calculate the present value factors or zero prices</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-linalg-function-solve">The linalg function <font color="green">solve</font></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-three-bond-least-squares-solution">The three bond least-squares solution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Define the payoff matrix. prices, and full rank of payoff matrix.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-transpose-of-payoffs-three-bonds-with-transpose-attribute-of-numpy-arrays">Calculate the transpose of <font color="green">payoffs_three_bonds</font> with transpose attribute of NumPy arrays.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-and-display-multiplying-transpose-into-original-matrix-and-into-price-matrix">Calculate and display multiplying transpose into original matrix and into price matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solve-for-present-value-factors">Solve for present value factors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-linalg-function-lstsq">The linalg function <font color="green">lstsq</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-lstsq-function-returns-four-values">The <font color="green">lstsq</font> function returns four values:</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Financial Python
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025 by Arbitrage Partners..
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>